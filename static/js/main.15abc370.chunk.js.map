{"version":3,"sources":["Main.jsx","Jobs/Public.jsx","MultiThread.jsx","Jobs/Private.jsx","Parcels/index.jsx","Parcels/View.jsx","Contracts/index.jsx","Join.jsx","Overview.jsx","Contacts/index.jsx","Contacts/New.jsx","Contacts/Edit.jsx","Labels/index.jsx","App.jsx","serviceWorker.js","index.js","QRReader.jsx","Contracts/New.jsx","utils.js"],"names":["Box","maxWidth","mx","marginTop","px","Card","Flex","flexDirection","title","to","style","alignSelf","Button","mainColor","alignItems","Heading","my","creator","useState","lat","lng","pos","setPos","hexs","setHexs","zones","setZones","name","setName","contracts","setContracts","threadMgr","setThreadMgr","web3","Web3","givenProvider","useEffect","navigator","geolocation","getCurrentPosition","coords","latitude","longitude","err","alert","message","getProfile","useCallback","a","displayName","text","loading","Loader","size","window","ethereum","request","method","user","Tooltip","placement","Blockie","opts","seed","openBox","box","syncDone","Promise","all","public","get","getSpace","Object","keys","length","toLowerCase","openSpace","refreshContracts","validContract","post","type","eth","getBlockNumber","expires","zone","addr","id","joinThreadByAddress","thread","getPosts","posts","map","isContract","filter","_","i","w","theta","Math","PI","start","floor","sin","one","full","polys","Array","rows","row","p","x","y","cos","poly","center","index","col","every","sqrt","pow","onPathCreate","console","info","onPathDelete","zoom","TileLayer","url","attribution","FeatureGroup","position","onDrawStart","evt","onDrawStop","onCreated","onDeleted","draw","polyline","polygon","marker","rectangle","circlemarker","circle","shapeOptions","color","Marker","Popup","Polygon","key","includes","positions","onClick","z","Table","distanceBetween","toFixed","con","pickup","waypoint","travelTime","dropoff","Form","onSubmit","Input","follow","threadAddr","space","onUpdate","contract","log","revs","out","rev","author","postId","status","setStatus","cards","setCards","updateStatus","watchForJobs","provider","currentProvider","Error","accounts","create","getAccounts","joinThread","inbox","limit","timestamp","awaiting","getConfig","config","links","address","docs","count","cs","_3id","signJWT","payload","error","c","JSON","stringify","scanning","setScanning","data","setData","history","useHistory","QRReader","onScan","match","push","location","Field","label","required","width","placeholder","value","onChange","target","Icon","props","setLoading","setLog","logger","msg","checkForParcel","guid","waitSync","params","setText","top","setTop","obj","useRef","texts","Grower","Supplier","Supply","Unboxing","Testing","Packaging","Bundling","Drop","Rideshare","Shopping","Payment","Fulfillment","current","addEventListener","svg","contentDocument","querySelector","nodes","querySelectorAll","node","getAttributeNS","desc","idx","undefined","textAlign","padding","left","right","margin","backgroundColor","border","borderRadius","ref","display","setPubKey","setAddr","setBox","setInfo","contacts","setContacts","modalOpen","setModalOpen","toast","load3Box","loadContacts","private","k","join","query","profileGraphQL","profiles","cp","profile","eth_address","image","name3","copyKey","selection","getSelection","range","document","createRange","selectNodeContents","removeAllRanges","addRange","execCommand","addMessage","secondaryMessage","variant","icon","mt","mr","Modal","isOpen","Text","icononly","mb","path","encodeURI","absolute","justifyContent","overflow","textOverflow","keylink","py","borderTop","borderColor","entries","className","src","commafy","names","href","confirm","remove","ToastMessage","Provider","URLSearchParams","useLocation","search","setNames","did","setDID","boxProfile","setBoxProfile","saveText","setSaveText","updateBoxProfile","val","startsWith","DID","existing","Set","saveContact","entry","n","trim","set","parcels","ml","newName","slice","marginRight","Outline","disabled","imageCID","setImageCID","boxLoader","setBoxLoader","contentUrl","txt","test","height","page","setPage","setLabel","innerGutter","setInnerGutter","outerGutter","setOuterGutter","presets","setters","genData","round","cols","ids","genId","resolve","reject","QRCode","toString","errorCorrectionLevel","string","qrs","qr","chunk","setter","dim","axis","old","buffer","uuidv1","base58","lbl","datum","initY","qrSize","min","transform","textAnchor","fontFamily","fontSize","r","dy","ceil","idView","xlinkHref","encodeURIComponent","preset","prop","opt","viewBox","ridx","cidx","currentNet","setCurrentNet","setNet","net","getId","mobile","userAgent","currentNetwork","requiredNetwork","notWeb3CapableBrowserMessage","MetaMaskButton","as","noNetworkAvailableMessage","exact","component","Main","Overview","EditContact","NewContact","Contacts","PublicJobs","PrivateJobs","ViewParcel","Parcels","NewContract","Join","Contracts","Labels","Boolean","hostname","ReactDOM","render","StrictMode","getElementById","serviceWorker","ready","then","registration","unregister","catch","delay","onError","maxHeight","setType","mark","setMark","setBoundsRadius","other","setOther","time","setTime","bond","setBond","couriers","setCouriers","scanner","setScanner","b58","setGUID","ScrollTrigger","register","gsap","permissions","result","state","actual","hashchange","removeEventListener","updateType","delta","textBounds","dragMarker","latlng","pageIcons","pageDescs","navbuttons","onBack","onNext","nextAvail","postToInbox","recipient","app","indent","draggable","onDrag","capitalize","radius","bounds","fill","stroke","parseFloat","when","contact","cursor","checked","guidBytes","replace","crypto","subtle","digest","hash","Buffer","from","threadName","createConfidentialThread","addMember","courier","list","len","word","split","toUpperCase","toRadian","degree","origin","destination","1","2","asin","isStr","arr","nxt","splice"],"mappings":"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","file":"static/js/main.15abc370.chunk.js","sourcesContent":["import React from 'react'\nimport { Button, Card, Box, Flex, Heading } from 'rimble-ui'\nimport { Link } from 'react-router-dom'\nimport './App.css'\n\nexport default () => {\n  return <>\n    <Box maxWidth='45em' mx='auto' marginTop='1.5em' px={[3, 3, 4]}>\n      <Card><Flex flexDirection='column'>\n        <h1>The <acronym title='Department of Happiness'>DoH</acronym>'s Ad Hoc Courier Service</h1>\n        <Link to='/overview' style={{ alignSelf: 'center' }}>\n          <Button mainColor='DarkCyan'>Overview</Button>\n        </Link>\n      </Flex></Card>\n    </Box>\n    <Box>\n      <Card maxWidth='25em' mx='auto' marginTop='1.5em' px={[3, 3, 4]}>\n        <Flex alignItems='center'  flexDirection='column'>\n          <Heading>Anyone</Heading>\n          <Link to='/ppl'>\n            <Button mx='auto' my='0.5em'>Manage Contacts</Button>\n          </Link>\n          <Link to='/labels'>\n            <Button mx='auto' my='0.5em'>Print Labels</Button>\n          </Link>\n        </Flex>\n      </Card>\n      <Card maxWidth='25em' mx='auto' marginTop='1.5em'>\n        <Flex alignItems='center' flexDirection='column'>\n          <Heading>Couriers</Heading>\n          <Link to='/jobs/public'>\n            <Button mx='auto' my='0.5em'>Find Public Jobs</Button>\n          </Link>\n          <Link to='/jobs/private'>\n            <Button mx='auto' my='0.5em'>Check Private Jobs</Button>\n          </Link>\n          <Link to='/parcels'>\n            <Button mx='auto' my='0.5em'>Investigate Parcels</Button>\n          </Link>\n          <Link to='/drive'>\n            <Button mx='auto' my='0.5em'>Drive</Button>\n          </Link>\n        </Flex>\n      </Card>\n      <Card maxWidth='25em' mx='auto' marginTop='1.5em' px={[3, 3, 4]}>\n        <Flex alignItems='center'  flexDirection='column'>\n          <Heading>Shippers</Heading>\n          <Link to='/contracts/new'>\n            <Button mx='auto' my='0.5em'>Ship a Parcel</Button>\n          </Link>\n        </Flex>\n      </Card>\n    </Box>\n  </>\n}","import React, { useState, useEffect, useCallback } from 'react'\nimport { Map as LeafletMap, Marker, Popup, TileLayer, Polygon, FeatureGroup } from 'react-leaflet'\nimport { EditControl } from 'react-leaflet-draw'\nimport {\n  Text, Blockie, Card, Flex, Heading,\n  Table, Form, Input, Button, Loader,\n  Icon, Tooltip\n} from 'rimble-ui'\nimport Box from '3box'\n//import 'leaflet/dist/leaflet.css'\nimport 'leaflet-draw/dist/leaflet.draw.css'\nimport Web3 from 'web3'\nimport { distanceBetween } from '../utils'\n\nconst creator = '0xC33290860C1DA6a84195C5cf1575860d3A3ED73d' // to look up zones space\nconst zonesSpace = 'courier-zones'\n\nexport default () => {\n  const [pos, setPos] = useState({ lat: -0.09, lng: 51.505 })\n  const [hexs, setHexs] = useState([])\n  const [zones, setZones] = useState([])\n  const [name, setName] = useState()\n  const [contracts, setContracts] = useState({})\n  const [threadMgr, setThreadMgr] = useState()\n  const web3 = new Web3(Web3.givenProvider)\n\n  useEffect(() => {\n    const success = (pos) => setPos({ lat: pos.coords.latitude, lng: pos.coords.longitude })\n    const error = (err) => alert(`Error Getting Current Position: '${err.message}'`)\n    navigator.geolocation.getCurrentPosition(success, error)\n  }, [])\n\n  const getProfile = useCallback(async () => {\n    const displayName = (text, loading = false) => (\n      <Flex alignItems='center' flexDirection='column'>\n        <Heading>{text}</Heading>\n        {loading && <Loader size='80px'/>}\n      </Flex>\n    )\n\n    try {\n      setName(displayName('Loading Profile…', true))\n      const user = (\n        await window.ethereum.request({ method: 'eth_requestAccounts' })\n      )[0]\n      setName(displayName(\n        <Tooltip message={user} placement='bottom'>\n          <Flex alignItems='center' flexDirection='column'>\n            <Heading>Researching</Heading>\n            <Blockie opts={{ seed: user, size: 50 }}/>\n          </Flex>\n        </Tooltip>,\n        true\n      ))\n      const box = await Box.openBox(user, Web3.givenProvider)\n      setName(displayName('Opened Box…', true))\n      await box.syncDone\n      setName(displayName('Getting Name…', true))\n      await Promise.all([\n        (async () => setName(displayName(\n          `Welcome ${await box.public.get('name')}`\n        )))(),\n        (async () => {\n          let threadMgr = await Box.getSpace(creator, zonesSpace)\n          if(Object.keys(threadMgr).length === 0) {\n            if(user.toLowerCase() === creator.toLowerCase()) {\n              threadMgr = await box.openSpace(zonesSpace)\n            } else {\n              alert(\"Couldn't find the thread manager.\")\n            }\n          }\n          setThreadMgr(threadMgr)\n        })(),\n      ])\n    } catch(err) {\n      alert(`Error Connecting to 3Box: '${err.message}'`)\n      setName(displayName('Loading Failed'))\n    }\n  }, []) // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(() => { getProfile() }, [getProfile])\n\n  const refreshContracts = useCallback(async (zones) => {\n    if(threadMgr) {\n      const validContract = async (post) => (\n        post.type === 'contract'\n        && (await web3.eth.getBlockNumber()) <= post.expires\n      )\n      const contracts = {}\n      for(let zone of zones) {\n        if(!zone.addr) {\n          zone.addr = await threadMgr.public.get(`zone-db-${zone.id}`)\n        }\n        if(zone.addr) {\n          const thread = await threadMgr.joinThreadByAddress(zone.addr)\n          const posts = await thread.getPosts()\n          const isContract = await Promise.all(posts.map(validContract))\n          contracts[zone.id] = posts.filter((_, i) => isContract[i])\n        }\n      }\n      setContracts(contracts)\n    }\n  }, [threadMgr])\n\n  useEffect(() => { refreshContracts(zones) }, [refreshContracts, zones])\n\n  useEffect(() => {\n    const w = 0.015\n    const theta = 2 * Math.PI / 6\n    const start = {\n      row: Math.floor(pos.lng / (2 * w)),\n      col: Math.floor(pos.lat / (2 * w * Math.sin(theta))),\n    }\n    const rows = 12\n    const cols = 35\n    const one = {\n      width: 2 * w * Math.sin(theta), height: 2 * w,\n    }\n    const full = {\n      width: cols * one.width, height: rows * one.height,\n    }\n    const polys = (\n      [...new Array(rows * cols)].map((_, i) => {\n        const row = Math.floor(i / rows)\n        const p = {\n          x: (\n            pos.lng + row * 1 * w * Math.sin(theta)\n            - (full.width / 4 - one.width / 2)\n          ),\n          y: (\n            pos.lat + (i % rows) * 3 * w\n            - (3 * full.height / 4 + one.height / 2)\n          ),\n        }\n        if(row % 2 === 1) {\n          p.y += 3 * w * Math.cos(theta)\n        }\n        const poly = [\n          [p.y - w, p.x],\n          [p.y - w * Math.cos(theta), p.x + w * Math.sin(theta)],\n          [p.y + w * Math.cos(theta), p.x + w * Math.sin(theta)],\n          [p.y + w, p.x],\n          [p.y + w * Math.cos(theta), p.x - w * Math.sin(theta)],\n          [p.y - w * Math.cos(theta), p.x - w * Math.sin(theta)],\n        ]\n        poly.center = { lat: p.y, lng: p.x }\n        poly.index = { row: start.row + row, col: start.col + i % cols }\n        poly.id = `(${poly.index.row},${poly.index.col})`\n        poly.contracts = []\n        return poly\n      })\n    )\n    setHexs(polys)\n\n    const r = w * 10\n    const zones = polys.filter((poly) => (\n      poly.every((p) => (\n        Math.sqrt(Math.pow(p[1] - pos.lng, 2) + Math.pow(p[0] - pos.lat, 2)) <= r\n      ))\n    ))\n    setZones(zones)\n  }, [pos])\n\n  const onPathCreate = console.info\n  const onPathDelete = console.info\n  const onDrawStop = (evt) => {\n    console.info('DSTP', evt)\n  }\n  const onDrawStart = (evt) => {\n    console.info('DSTRT', evt)\n  }\n\n  return (\n    <Flex alignItems='center' flexDirection='column'>\n      {name &&\n        <Card><Heading>{name}</Heading></Card>\n      }\n      <Heading>#1. Select Your Availability Zone</Heading>\n      <LeafletMap center={pos} zoom={11}>\n        <TileLayer\n          url=\"https://{s}.tile.osm.org/{z}/{x}/{y}.png\"\n          attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n        />\n        <FeatureGroup>\n          <EditControl\n            position='topleft'\n            onDrawStart={onDrawStart}\n            onDrawStop={onDrawStop}\n            onCreated={onPathCreate}\n            onDeleted={onPathDelete}\n            draw={{\n              polyline: false,\n              polygon: false,\n              marker: false,\n              rectangle: false,\n              circlemarker: false,\n              circle: {\n                shapeOptions: { color: '#FF0000AA' },\n              },\n            }}\n          />\n        </FeatureGroup>\n        <Marker position={pos}>\n          <Popup>You are here.</Popup>\n        </Marker>\n        {hexs.map((p, i) => (\n          <Polygon key={i}\n            color={\n              !zones.includes(p)\n              ? '#AF05F722'\n              : (p.addr ? '#048A0999' : '#FF7B0099')\n            }\n            positions={p}\n            onClick={() => {\n              setZones((zones) => {\n                const select = !zones.includes(p)\n                if(select) {\n                  return [p, ...zones]\n                } else {\n                  return zones.filter(z => z !== p)\n                }\n              })\n            }}\n          />\n        ))}\n      </LeafletMap>\n      <Table>\n        <thead><tr>\n          <th>Zone ID</th>\n          <th># of Open Contracts</th>\n          <th>🕊 to Center</th>\n        </tr></thead>\n        <tbody>\n          {zones.map((zone) => (\n            <tr key={zone.id}>\n              <td>{zone.id}</td>\n              <td>{zone.contracts.length}</td>\n              <td>{(distanceBetween(pos, zone.center) / 1000).toFixed(2)}km</td>\n            </tr>\n          ))}\n        </tbody>\n      </Table>\n      <Table>\n        <thead><tr>\n          <th>🕊 to Pickup Waypoint</th>\n          <th>Waypoint to Sender</th>\n          <th>🕊 Pickup to Dropoff Waypoint</th>\n          <th>Waypoint to Recipient</th>\n          <th>Bid</th>\n        </tr></thead>\n        <tbody>\n          {zones.map((zone) => (\n            (contracts[zone.id] || []).map((con) => (\n              <tr id={zone.id} key={zone.id}>\n                <td>{con.pickup.waypoint}</td>\n                <td>{con.pickup.travelTime}</td>\n                <td>{con.dropoff.waypoint + con.pickup.waypoint}</td>\n                <td>{con.dropoff.travelTime}</td>\n                <td>\n                  <Form onSubmit={alert}>\n                    <Input type='number' name='bid' />\n                    <Button>Bid</Button>\n                  </Form>\n                </td>\n              </tr>\n            ))\n          ))}\n        </tbody>\n      </Table>\n    </Flex>\n  )\n}\n","export const follow = async (threadAddr, { space, onUpdate }) => {\n  const contract = await space.joinThreadByAddress(threadAddr)\n\n  if(onUpdate) {\n    contract.onUpdate(console.log)\n  }\n\n  const revs = await contract.getPosts()\n  const out = {}\n  for(let rev of revs) {\n    out[rev.author] = { id: rev.postId, ...rev.message }\n  }\n  return out\n}\n","import React, { useState, useEffect, useCallback } from 'react'\nimport Box from '3box'\nimport { Loader, Flex, Heading, Card } from 'rimble-ui'\nimport Web3 from 'web3'\nimport IdentityWallet from 'identity-wallet'\nimport ThreeIdResolver from '@ceramicnetwork/3id-did-resolver'\nimport { Resolver } from 'did-resolver'\nimport { follow } from '../MultiThread'\n\nexport default () => {\n  const [status, setStatus] = useState({\n    text: 'Initializing…', color: 'blue'\n  })\n  const [cards, setCards] = useState([])\n  const updateStatus = (text, color) => (\n    setStatus({ text, color })\n  )\n\n  const watchForJobs = useCallback(async () => {\n    try {\n      let provider = Web3.givenProvider\n      if(!provider) {\n        provider = window.web3 && window.web3.currentProvider\n      }\n      if(!provider) {\n        throw new Error(\"Couldn't Find an Ethereum Provider.\\n\\nCan't connect to databases.\")\n      }\n      const web3 = new Web3(provider)\n      console.info('ACCT', web3.eth.accounts.create())\n      updateStatus(`Getting Address…`, 'pink')\n      const user = (await web3.eth.getAccounts())[0]\n      updateStatus(`Opening 3Box: ${user}…`, 'orange')\n      const box = await Box.openBox(user, provider)\n      updateStatus(`Got 3Box…`, 'green')\n      const space = await box.openSpace('courier')\n      updateStatus(`Got Courier Space…`, 'blue')\n      const inbox = await space.joinThread('inbox')\n      updateStatus(`Got Inbox Thread…`, 'red')\n      const limit = 20\n      const posts = await inbox.getPosts({ limit })\n      updateStatus(`Got ${posts.length} Entr${posts.length === 1 ? 'y' : 'ies'}…`, 'blue')\n\n      //for(let { postId: id } of posts) inbox.deletePost(id)\n\n      // const getConsent = async ({ type, origin, spaces }) => {\n      //   // For testing purposes a function that just returns\n      //   // true can be used. In production systems the user\n      //   // should be prompted for input.\n      //   return true\n      // }\n      // const wallet = new IdentityWallet(getConsent, { ethereumAddress: user })\n      // console.info('MSG', await wallet.encrypt(\"message\", 'courier'))\n\n      for(let { message, author, timestamp, postId: id } of posts) {\n        if(message.awaiting) {\n          const config = await Box.getConfig(author)\n          updateStatus(`Getting 3Box…`, 'green')\n          const box = await Box.openBox(config.links[0].address, provider)\n          updateStatus(`Got 3Box.`, 'green')\n          const space = await box.openSpace('courier')\n          updateStatus(`Got Parcels Space…`, 'blue')\n          const docs = await follow(message.awaiting, { space, onUpdate: () => {\n            console.info('UPDT')\n          } })\n          const count = Object.keys(docs).length\n          updateStatus(`Got ${count} Author${count === 1 ? '' : 's'}…`, 'blue')\n          setCards(cs => [docs, ...cs])\n          console.info(await box._3id.signJWT(\n            { payload: 'test' }, { space: 'courier'  }\n          ))\n        } else if(message.contract) {\n          console.info('CTCT', message)\n        } else {\n          console.error('Unknown Inbox Post Type', message)\n        }\n      }\n    } catch(err) {\n      console.error(err)\n      alert(err.message)\n    }\n    updateStatus('Done')    \n  }, [])\n\n  useEffect(() => { watchForJobs() }, [watchForJobs])\n\n  return (\n    <Flex alignItems='center' flexDirection='column'>\n      <Heading>Private Jobs</Heading>\n      {status &&\n        <Flex alignItems='center' flexDirection='column'>\n          <Heading>{status.text}</Heading>\n          {status.color && <Loader color={status.color}/>}\n        </Flex>\n      }\n      {cards.map((c, i) => (\n        <Card key={i}>{JSON.stringify(c)}</Card>\n      ))}\n    </Flex>\n  )\n}","import React, { useState } from 'react'\nimport {\n  Tooltip, Button, Card, Icon,\n  Flex, Heading, Field, Input\n} from \"rimble-ui\"\nimport { useHistory } from 'react-router-dom'\nimport QRReader from '../QRReader'\n\nexport default () => {\n  const [scanning, setScanning] = useState(false)\n  const [data, setData] = useState()\n  const history = useHistory()\n\n  const onScan = (data) => {\n    if(data) {\n      setData(data)\n      const match = data.match(/^https?:\\/\\/(pkg|sw).dhappy.org(\\/cel\\/([^/]*)(\\/(.+))?$)/)\n      console.info(data, match)\n      if(match) {\n        setScanning(false)\n        setData(match[3])\n        if(match[1] === 'pkg') {\n          history.push(match[2])\n        } else {\n          window.location = match[0]\n        }\n      }\n    }\n  }\n\n  return (\n    <Flex alignItems='center' flexDirection='column'>\n      {scanning\n        ? (\n          <QRReader onScan={onScan}/>\n        )\n        : (\n          <Field label=\"Package ID\">\n            <Flex alignItems='center' flexDirection='row'>\n              <Input type='text' required={true}\n                width='20em'\n                placeholder='128 bits base58 encoded'\n                value={data} onChange={evt => setData(evt.target.value)}\n              />\n              <Tooltip message='Read QR Code'>\n                <Button onClick={() => setScanning(true)}>\n                  <Icon name='Pages'/>\n                </Button>\n              </Tooltip>\n            </Flex>\n          </Field>\n        )\n      }\n    </Flex>\n  )   \n}","import React, { useState, useEffect, useCallback } from 'react'\nimport { Flex, Heading, Button, Input, Card, Loader } from 'rimble-ui'\nimport { HashLink as Link } from 'react-router-hash-link'\nimport { Redirect } from 'react-router-dom'\nimport Box from '3box'\nimport Web3 from 'web3'\n\nexport default (props) => {\n  const [loading, setLoading] = useState(false)\n  const [log, setLog] = useState([])\n  const logger = (msg) => setLog(log => [...log, msg])\n\n  const checkForParcel = useCallback(async (guid) => {\n    setLoading(true)\n    const user = (\n      await window.ethereum.request({ method: 'eth_requestAccounts' })\n    )[0]\n    logger(`Got Address: ${user}`)\n    const box = await Box.openBox(user, Web3.givenProvider)\n    logger(`Awaiting 3Box…`)\n    await box.waitSync\n    logger(`Got 3Box…`)\n    const space = await box.openSpace('courier-parcels')\n    logger(`Got Courier Space…`)\n    const inbox = await space.joinThread(`thread-${guid}`)\n    logger(`Got ${guid} Thread…`)\n    const limit = 10\n    const posts = await inbox.getPosts({ limit })\n    logger(`Got ${posts.length} Entr${posts.length === 1 ? 'y' : 'ies'}…`)\n    setLoading(false)\n  }, [])\n\n  useEffect(() => { checkForParcel(props.match.params.guid) }, [])\n\n  return (\n    <Flex alignItems='center' flexDirection='column'>\n      <Heading>Package Viewer</Heading>\n      <Heading>{props.match.params.guid}</Heading>\n\n      {loading && <Loader/>}\n\n      <ul>\n        {log.map((msg, i) => <li key={i}>{msg}</li>)}\n      </ul>\n    </Flex>\n  )\n}","import React, { useEffect, useState, useCallback } from 'react'\n\nexport default () => {\n  return <h1>Contracts</h1>\n}","import React from 'react'\n\nexport default () => {\n  return <h1>Join</h1>\n}","import React, { useEffect, useRef, useState } from 'react';\n\nexport default () => {\n  const [text, setText] = useState()\n  const [name, setName] = useState()\n  const [top, setTop] = useState('1em')\n  const obj = useRef(null)\n\n  const texts = {\n    Grower: <p>Produces the raw materials for production of the substance.</p>,\n    Supplier: <p>Processes the raw materials into a consumable form.</p>,\n    Supply: <p>The final product is a large quantity of the consumable.</p>,\n    Unboxing: <>\n      <p>The plug receives a part of the supply and measures the amount received.</p>\n      <p><i>This is recorded for potential disputes with the supplier.</i></p>\n    </>,\n    Testing: <>\n      <p>The plug performs available tests on the supply.</p>\n      <p><i>This is recorded for the customer and supplier.</i></p>\n    </>,\n    Packaging: <>\n      <p>The plug divides the supply into smaller units.</p>\n      <p><i>Each packaging is recorded for inclusion in the inventory.</i></p>\n    </>,\n    Bundling: <p>Packages are labeled with GUIDs and gathered in a locked bundle.</p>,\n    Drop: <p>A courier picks up the bundle.</p>,\n    Rideshare: <>\n      <p>Customers select their pick-up and destination areas.</p>\n    </>,\n    Shopping: <>\n      <p>On an in-car tablet, they communicate with a plug as to inventory.</p>\n      <p><i>The shop includes the testing and packaging recordings for each parcel.</i></p>\n    </>,\n    Payment: <p>Payment for a parcel is transmitted via IOTA.</p>,\n    Fulfillment: <p>The courier gives the customer their purchase.</p>,\n  }\n\n  const svgEvents = () => {\n    obj.current.addEventListener(\n      'load',\n      () => {\n        let svg = obj.current.contentDocument.querySelector('svg')\n        if(!svg) { alert(\"Couldn't find SVG.\") }\n        let nodes = svg.querySelectorAll(\"[*|label='Icons'] > *\")\n        console.info(nodes)\n        if(!nodes || nodes.length === 0) { alert(\"Couldn't find nodes.\") }\n        const ns = 'http://www.inkscape.org/namespaces/inkscape'\n        for(let node of nodes) {\n          const name = node.getAttributeNS(ns, 'label')\n          let desc, idx = 0\n          for(let key in texts) { // relies on non-standard order maintenance\n            desc = texts[key]\n            if(key === name) break\n            idx++\n          }\n          if(idx === Object.keys(texts).length) {\n            desc = undefined\n          }\n\n          let marginTop = '20em'\n          const row = Math.floor(idx / 3)\n          switch(row) {\n            case 0: marginTop = '30%'; break\n            case 1: marginTop = '15%'; break\n            case 2: marginTop = '25em'; break\n            case 3: marginTop = '65%'; break\n            default: marginTop = `${row * 25}em`\n          }\n\n          node.addEventListener(\n            'mouseover',\n            () => {\n              if(!desc) {\n                alert(`Couldn't Find: ${name}`)\n              } else {\n                setName(name)\n                setText(desc)\n                setTop(marginTop)\n              }\n            },\n            true\n          )\n          node.addEventListener(\n            'mouseout',\n            () => {\n              setName(undefined)\n              setText(undefined)\n            },\n            true\n          )\n        }\n      },\n      true\n    )\n  }\n  useEffect(svgEvents, [])\n\n  const hide = () => {\n    setText(undefined)\n  }\n\n  return <>\n    {text && (\n      <div onClick={hide} style={{ textAlign: 'center', padding: '1em', left: 0, right: 0, position: 'absolute', margin: 'auto', maxWidth: '45em', top: top, backgroundColor: 'yellow', border: '2px solid black', borderRadius: '1.5em' }}>\n        <h1>{name}</h1>\n        {text}\n      </div>\n    )}\n    <object id='chain' data='chain.svg' ref={obj} style={{ display: 'block', maxWidth: '45em', margin: 'auto' }}/>\n  </>\n}","import React, { useState, useRef, useEffect } from 'react'\nimport {\n  Box as LayoutBox, Flex, Heading, Text,\n  Button, Icon, Input, ToastMessage,\n  Modal, Card, Table, Loader\n} from 'rimble-ui'\nimport { HashLink as Link } from 'react-router-hash-link'\nimport Box from '3box'\nimport Web3 from 'web3'\nimport { commafy } from '../utils'\n\nexport default () => {\n  const [pubkey, setPubKey] = useState()\n  const [name, setName] = useState('')\n  const [addr, setAddr] = useState()\n  const [box, setBox] = useState()\n  const [info, setInfo] = useState()\n  const [contacts, setContacts] = useState()\n  const [modalOpen, setModalOpen] = useState(false)\n  const url = useRef(null)\n  const toast = useRef(null)\n\n  const load3Box = async () => {\n    try {\n      let provider = Web3.givenProvider\n      if(!provider) {\n        provider = window.web3 && window.web3.currentProvider\n      }\n      if(!provider) {\n        throw new Error(\"Couldn't Find an Ethereum Provider.\\n\\nCan't connect to databases.\")\n      }\n      const web3 = new Web3(provider)\n      const user = (await web3.eth.getAccounts())[0]\n      setAddr(user)\n      setBox(await Box.openBox(user, web3.currentProvider))\n    } catch(err) {\n      alert(err.message)\n    }\n  }\n\n  useEffect(() => { load3Box() }, [])\n\n  const loadContacts = async () => {\n    if(box) {\n      const contacts = await box.openSpace('courier-contacts')\n      await contacts.syncDone\n      setContacts(contacts)\n      const info = await contacts.private.all()\n      setInfo(info)\n      const keys = `[${Object.keys(info).map(k => `\"${k}\"`).join(',')}]`\n      const query = (\n        `{ profiles(ids: ${keys}) { name eth_address image } }`\n      )\n      const profiles = (await Box.profileGraphQL(query)).profiles\n      setInfo((info) => {\n        let cp = {...info}\n        for(let profile of profiles) {\n          cp[profile.eth_address].image = profile.image\n          cp[profile.eth_address].name3 = profile.name\n        }\n        return cp\n      })\n    }\n  }\n\n  useEffect(() => { loadContacts() }, [box])\n\n  const getPubKey = async () => {\n    try {\n      const accounts = (\n        await window.ethereum.request({ method: 'eth_requestAccounts' })\n      )\n      setAddr(accounts[0])\n      setPubKey(await window.ethereum.request({\n        jsonrpc: '2.0',\n        method: 'eth_getEncryptionPublicKey',\n        params: [accounts[0]],\n        from: accounts[0],\n      }))\n    } catch(err) {\n      alert(err.message)\n    }\n  }\n\n  const copyKey = () => {\n    try {\n      const selection = window.getSelection()\n      const range = document.createRange()\n      range.selectNodeContents(url.current)\n      selection.removeAllRanges()\n      selection.addRange(range)\n      document.execCommand('copy')\n      selection.removeAllRanges()\n\n      toast.current.addMessage('Copied to Clipboard', {\n        secondaryMessage: 'URL is ready to paste…',\n        variant: 'default',\n        icon: 'Assignment',\n      })\n    } catch(err) {\n      alert(err.message)\n    }\n  }\n\n  const keylink = () => {\n    const path = `/ppl/new?alias=${encodeURI(name)}&address=${addr}`\n    const absolute = `https://pkg.dhappy.org/#${path}`\n\n    return <>\n      <Input placeholder='What do they call you?'\n        value={name} onChange={evt => setName(evt.target.value)}\n      />\n      {name && <>\n        <Text>To invite contacts, send them this:</Text>\n        <Flex alignItems='center' justifyContent='center' flexDirection='row'>\n          <Link to={path} ref={url} style={{overflow: 'hidden', textOverflow: 'ellipsis' }}>{absolute}</Link>\n          <Button onClick={copyKey} title='Copy to Clipboard' mx={2} size='small'>\n            <Icon name='Assignment'/>\n          </Button>\n        </Flex>\n      </>}\n    </>\n  }\n\n  return (\n    <Flex alignItems='center' flexDirection='column' position='relative'>\n      <Heading>Contacts</Heading>\n\n      <Button onClick={() => setModalOpen(true)} icon='Share'\n        position='absolute' top={0} right={0} mt={3} mr={3}\n        title='Invite Contacts'\n      />\n      <Modal isOpen={modalOpen}>\n        <Card p={0}>\n          <Button.Text icononly icon='Close' color='moon-gray'\n            position='absolute' top={0} right={0} mt={3} mr={3}\n            onClick={() => setModalOpen(false)} title='Close'\n          />\n\n          <LayoutBox p={4} mb={3}>\n            <Heading>Invitation Link</Heading>\n            {keylink()}\n          </LayoutBox>\n\n          <Flex px={4} py={3} borderTop={1}\n            borderColor='#E8E8E8' justifyContent='flex-end'\n          >\n            <Button onClick={() => { setPubKey(); setModalOpen(false) }}\n            >Done</Button>\n          </Flex>\n        </Card>\n      </Modal>\n\n      {!info\n        ? (\n          <Card><Flex alignItems='center' flexDirection='column'>\n            <Text>Loading Contacts</Text><Loader size='large' mt={3}/>\n          </Flex></Card>\n        )\n        : (Object.keys(info).length === 0\n          ? <Heading>No Contacts</Heading>\n          : (\n            <Table>\n              <thead><tr>\n                <th>Avatar</th><th>Names</th><th>3Box Name</th><th>Actions</th>\n              </tr></thead>\n              <tbody>\n                {Object.entries(info).map(([addr, info]) => (\n                  <tr key={addr}>\n                    <td>{info.image && <img className='avatar' src={`//ipfs.io/ipfs/${info.image}`}/>}</td>\n                    <td title={`Public Key: ${info.key}`}>{commafy(info.names)}</td>\n                    <td><a href={`//3box.io/${addr}`} target='_blank' title='3Box Profile'>{info.name3}</a></td>\n                    <td>\n                      <Link to={`/contacts/${addr}/edit`}>\n                        <Button icon='Edit' mx={1}>Edit</Button>\n                      </Link>\n                      <Button variant='danger' icon='Delete' mx={1}\n                        onClick={() => {\n                          if(window.confirm(`Really Delete: ${commafy(info.names)}?`)) {\n                            contacts.private.remove(addr)\n                            setInfo(info => {\n                              const cp = {...info}\n                              delete(cp[addr])\n                              return cp\n                            })\n                          }\n                        }}\n                      >Delete</Button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </Table>\n          )\n        )\n      }\n      <ToastMessage.Provider ref={toast}/>\n    </Flex>\n  )\n}","import React, { useState, useEffect, useCallback } from 'react'\nimport { Heading, Button, Input, Card, Loader, Flex } from 'rimble-ui'\nimport { HashLink as Link } from 'react-router-hash-link'\nimport { useLocation, Redirect } from 'react-router-dom'\nimport Box from '3box'\nimport Web3 from 'web3'\n\nconst useQuery = () => new URLSearchParams(useLocation().search)\n\nexport default () => {\n  const query = useQuery()\n  const [names, setNames] = useState([query.get('alias')])\n  const [addr] = useState(query.get('address'))\n  const [did, setDID] = useState()\n  const [contacts, setContacts] = useState()\n  const [box, setBox] = useState()\n  const [boxProfile, setBoxProfile] = useState(\n    <Loader display='inline' title='Opening 3Box…'/>\n  )\n  const [saveText, setSaveText] = useState('Save')\n\n  let provider = Web3.givenProvider\n  if(!provider) {\n    provider = window.web3 && window.web3.currentProvider\n  }\n  const web3 = new Web3(provider)\n\n  const load3Box = useCallback(async () => {\n    try {\n      const user = (await web3.eth.getAccounts())[0]\n      const box = await Box.openBox(user, web3.currentProvider)\n      setBox(box)\n    } catch(err) {\n      alert(err.message)\n    }\n  }, [])\n\n  useEffect(() => { load3Box() }, [load3Box])\n\n  const updateBoxProfile = useCallback(async () => {\n    try {\n      setBoxProfile(<Loader color='orange' display='inline' title='Getting 3Box Profile…'/>)\n      const profile = await Box.getProfile(addr)\n      const entries = Object.entries(profile || {}).filter(\n        ([key, val]) => !key.startsWith('proof_') && typeof(val) !== 'object'\n      )\n      setBoxProfile(\n        (entries.length === 0)\n        ? <ul><li><i>Empty</i></li></ul>\n        : (\n          <ul>\n            {entries\n              .map(([key, val]) => (\n                <li key={key}><b>{key}:</b> {JSON.stringify(val)}</li>\n              ))\n            }\n          </ul>\n        )\n      )\n      console.info(provider, web3.currentProvider)\n      console.info('DID', (await Box.openBox(addr, web3.currentProvider)).DID)\n      setDID((await Box.openBox(addr, web3.currentProvider)).DID)\n    } catch(err) {\n      alert(err.message)\n    }\n  }, [addr])\n\n  useEffect(() => { updateBoxProfile() }, [updateBoxProfile])\n\n  const loadContacts = useCallback(async () => {\n    if(box) {\n      const contacts = await box.openSpace('courier-contacts')\n      await contacts.syncDone\n      setContacts(contacts)\n\n      const existing = await contacts.private.get(addr)\n      if(existing) {\n        setNames(names => [...(new Set(\n          [...names, ...existing.names]\n        ))])\n      }\n    }\n  }, [box])\n\n  useEffect(() => { loadContacts() }, [loadContacts])\n\n  const saveContact = async () => {\n    if(!contacts) {\n      console.error(\"Contact space isn't set\")\n    } else {\n      setSaveText(<Loader color='white'/>)\n      const entry = {\n        did, address: addr,\n        names: [...new Set(names.filter(n => n.trim() !== ''))],\n      }\n      await contacts.private.set(addr, entry)\n      await contacts.private.set(did, entry)\n      setSaveText(<Loader color='green'/>)\n\n      // Before a thread can be opened, the space it belongs to\n      // has to have been opened by the specific user\n      const other = await Box.openBox(addr, Web3.givenProvider)\n      const parcels = await box.openSpace('courier-parcels')\n      await parcels.syncDone\n      setSaveText('Done')\n    }\n  }\n\n  return (\n    <Flex flexDirection='column'><Card>\n      <Heading>Create a New Contact</Heading>\n      \n      <ul>\n        <li>\n          <b>Names:</b>\n          <ul>\n            {names.map((name, idx) => (\n              <li key={idx}>\n                <Input ml={2} value={name} my={2}\n                  onChange={(evt) => {\n                    const newName = evt.target.value\n                    setNames(\n                      (names) => [\n                        ...names.slice(0, idx),\n                        newName,\n                        ...names.slice(idx + 1)\n                      ]\n                    )\n                  }}\n                />\n                <Button title='Delete' mx={2} variant='danger' icon='Delete'\n                  onClick={() => setNames(names => {\n                    if(names.length === 1) {\n                      return ['']\n                    } else {\n                      return [...names.slice(0, idx), ...names.slice(idx + 1)]\n                    }\n                  })}\n                />\n                <Button title='Add' icon='Add'\n                  onClick={() => setNames(names => {\n                    return [...names.slice(0, idx + 1), '', ...names.slice(idx + 1)]\n                  })}\n                />\n              </li>\n            ))}\n          </ul>\n        </li>\n        <li><Flex flexDirection='row'>\n          <b style={{marginRight: '0.5em'}}>Decentralized ID:</b> {did ? did : <Loader/>}\n        </Flex></li>\n        <li><b>ETH Address:</b> {addr}</li>\n        <li>\n          <Flex flexDirection='row'>\n            <b>3Box Profile:</b> {!boxProfile && <Loader/>}\n          </Flex>\n          {boxProfile}\n        </li>\n      </ul>\n\n      <Flex justifyContent='flex-end'>\n        <Link to='/contacts'>\n          <Button.Outline mx={2}>Cancel</Button.Outline>\n        </Link>\n        <Button onClick={saveContact} variant='success  '\n          disabled={\n            names.filter(n => n !== '').length === 0\n            || saveText !== 'Save'\n          }\n        >{saveText}</Button>\n        {saveText === 'Done' && <Redirect to='/contacts'/>}\n      </Flex>\n    </Card></Flex>\n  )\n}","import React, { useState, useEffect, useCallback } from 'react'\nimport { Flex, Heading, Button, Input, Card, Loader } from 'rimble-ui'\nimport { HashLink as Link } from 'react-router-hash-link'\nimport { Redirect } from 'react-router-dom'\nimport Box from '3box'\nimport Web3 from 'web3'\n\nexport default (props) => {\n  const [names, setNames] = useState()\n  const [addr] = useState(props.match.params.address)\n  const [contacts, setContacts] = useState()\n  const [box, setBox] = useState()\n  const [imageCID, setImageCID] = useState()\n  const [boxLoader, setBoxLoader] = useState(\n    <Loader display='inline' title='Opening 3Box…'/>\n  )\n  const [boxProfile, setBoxProfile] = useState()\n  const [saveText, setSaveText] = useState('Save')\n\n  const load3Box = async () => {\n    const user = (\n      await window.ethereum.request({ method: 'eth_requestAccounts' })\n    )[0]\n    setBox(await Box.openBox(user, Web3.givenProvider))\n  }\n\n  useEffect(() => { load3Box() }, [])\n\n  const linkLink = (txt) => {\n    if(/^https?:\\/\\//.test(txt)) {\n      return <a href={txt}>{txt}</a>\n    } else {\n      return txt\n    }\n  }\n\n  const updateBoxProfile = useCallback(async () => {\n    setBoxLoader(<Loader color='orange' display='inline' title='Getting 3Box Profile…'/>)\n    const profile = await Box.getProfile(addr)\n    if(profile.image && profile.image.length > 0) {\n      setImageCID(profile.image[0].contentUrl['/'])\n    }\n    setBoxProfile(\n      (!profile || Object.keys(profile).length === 0)\n      ? <i>Empty</i>\n      : (\n        <ul>\n          {Object.entries(profile)\n          .filter(([key, val]) => !key.startsWith('proof_') && typeof(val) !== 'object')\n          .map(([key, val]) => (\n            <li key={key}><b>{key}:</b> {linkLink(val)}</li>\n          ))}\n        </ul>\n      )\n    )\n  }, [])\n\n  useEffect(() => { updateBoxProfile() }, [updateBoxProfile])\n\n  const loadContacts = useCallback(async () => {\n    if(box) {\n      const contacts = await box.openSpace('courier-contacts')\n      await contacts.syncDone\n      setContacts(contacts)\n\n      const existing = await contacts.private.get(addr)\n      if(existing) {\n        setNames(names => [...(new Set(\n          [...(names || []), ...existing.names]\n        ))])\n      } else {\n        alert(`Contact ${addr} Not Found`)\n      }\n    }\n  }, [box])\n\n  useEffect(() => { loadContacts() }, [loadContacts])\n\n  const saveContact = useCallback(async () => {\n    setSaveText(<Loader color='white'/>)\n    await contacts.private.set(addr, {\n      address: addr,\n      names: [...new Set(names.filter(n => n.trim() !== ''))],\n    })\n    setSaveText('Done')\n  }, [contacts])\n\n  return (\n    <Card width='50%' margin='auto'>\n      <Flex flexDirection='row' alignItems='center'>\n        {imageCID && <img className='avatar' src={`//ipfs.io/ipfs/${imageCID}`}/>}\n        <Heading ml={15}>Edit a Contact</Heading>\n      </Flex>\n\n      <ul>\n        <li>\n          <Flex flexDirection='row'>\n            <b>Names:</b>\n            {!names && <Loader title='Loading from 3Box…' mx={2}/>}\n          </Flex>\n          {names &&\n            <ul>\n              {names.map((name, idx) => (\n                <li key={idx}>\n                  <Input ml={2} value={name} my={2}\n                    onChange={(evt) => {\n                      const newName = evt.target.value\n                      setNames(\n                        (names) => [\n                          ...names.slice(0, idx),\n                          newName,\n                          ...names.slice(idx + 1)\n                        ]\n                      )\n                    }}\n                  />\n                  <Button title='Delete' mx={2} variant='danger' icon='Delete'\n                    onClick={() => setNames(names => {\n                      if(names.length === 1) {\n                        return ['']\n                      } else {\n                        return [...names.slice(0, idx), ...names.slice(idx + 1)]\n                      }\n                    })}\n                  />\n                  <Button title='Add' icon='Add'\n                    onClick={() => setNames(names => {\n                      return [...names.slice(0, idx + 1), '', ...names.slice(idx + 1)]\n                    })}\n                  />\n                </li>\n              ))}\n            </ul>\n          }\n        </li>\n        <li><b>ETH Address:</b> {addr}</li>\n        <li>\n          <Flex flexDirection='row'>\n            <b>3Box Profile:</b> {!boxProfile && boxLoader}\n          </Flex>\n          {boxProfile}\n        </li>\n      </ul>\n\n      <Flex justifyContent='flex-end'>\n        <Link to='/contacts'>\n          <Button.Outline mx={2}>Cancel</Button.Outline>\n        </Link>\n        <Button onClick={saveContact} variant='success  '\n          disabled={\n            (names || []).filter(n => n !== '').length === 0\n            || saveText !== 'Save'\n          }\n        >{saveText}</Button>\n        {saveText === 'Done' && <Redirect to='/contacts'/>}\n      </Flex>\n    </Card>\n  )\n}","import React, { useState, useEffect, useCallback } from 'react'\nimport {\n  Flex, Card, Field,\n} from 'rimble-ui'\nimport { v1 as uuidv1 } from 'uuid'\nimport * as base58 from 'bs58'\nimport QRCode from 'qrcode'\nimport { chunk } from '../utils'\n\nexport default () => {\n  const [page, setPage] = useState({width: 8.5, height: 11})\n  const [label, setLabel] = useState({width: 2 + 5/8, height: 2})\n  const [innerGutter, setInnerGutter] = useState({width: 1/8, height: 0})\n  const [outerGutter, setOuterGutter] = useState({width: 7/32, height: 15/32})\n  const [data, setData] = useState([])\n  const dpi = 96 // inkscape default\n  const presets = {\n    'Avery 6793 (15×(2\"×2⅝\"))': {\n      page: { width: 8.5, height: 11 },\n      label: { width: 2 + 5/8, height: 2 },\n      outerGutter: { width: 7/32, height: 15/32 },\n      innerGutter: { width: 1/8, height: 0 },\n    },\n    'Avery 6874 (6×(3\"×3¾\"))': {\n      page: { width: 8.5, height: 11 },\n      label: { width: 3 + 3/4, height: 3 },\n      outerGutter: { width: 3/8, height: 5/8 },\n      innerGutter: { width: 1/4, height: 3/8 },\n    },\n  }\n  const setters = {\n    page: setPage, label: setLabel,\n    innerGutter: setInnerGutter, outerGutter: setOuterGutter,\n  }\n\n  const genData = useCallback(async () => {\n    const rows = Math.round((page.height - outerGutter.height * 2 + innerGutter.height) / (label.height + innerGutter.height))\n    const cols = Math.round((page.width - outerGutter.width * 2 + innerGutter.width) / (label.width + innerGutter.width))\n\n    const ids = (\n      [...new Array(Math.round(rows * cols))].map(genId)\n    )\n    const qrs = await Promise.all(\n      ids.map((guid) => (\n        new Promise((resolve, reject) => {\n          QRCode.toString(\n            `https://pkg.dhappy.org/#/cel/${guid}`,\n            { margin: 0, errorCorrectionLevel: 'low' },\n            (err, string) => {\n              if(err) throw err\n              resolve(string)\n            }\n          )\n        })\n      ))\n    )\n    const data = ids.map((id, i) => ({ guid: id, qr: qrs[i] }))\n    setData(chunk(data, cols))\n  }, [page, label, outerGutter, innerGutter])\n\n  useEffect(() => { genData() }, [genData])\n\n  const setter = (dim, axis) => (\n    (evt) => {\n      const val = evt.target.value\n      if(!setters[dim]) {\n        console.error(`No Setter For: ${dim}`)\n      } else {\n        setters[dim](old => ({...old, [axis]: val}))\n      }\n    }\n  )\n\n  const genId = () => {\n    const buffer = new Array()\n    const uuid = uuidv1({}, buffer)\n    return base58.encode(buffer)\n  }\n\n  const idView = (guid) => {\n    const rows = chunk(guid, 8)\n    return (\n      <text style={{textAnchor: 'middle', fontFamily: \"'Source Code Pro', monospace\", fontSize: 25}} >\n        {rows.map((r, i) => (\n          <tspan key={i} x={label.height / 2 * dpi} dy={25}>{chunk(r, Math.ceil(r.length / 2)).join('-')}</tspan>\n        ))}\n      </text>\n    )\n  }\n\n  const lbl = (datum, row, col) => {\n    const x = (outerGutter.width + col * (label.width + innerGutter.width)) * dpi\n    const y = (outerGutter.height + row * (label.height + innerGutter.height)) * dpi\n    const initY = (outerGutter.height + label.height / 2) * dpi\n    const qrSize = Math.min(label.width, label.height) * 0.8 * dpi\n    return (\n      <g key={datum.guid} transform={`translate(${x}, ${y}) rotate(-90) translate(${-initY}, 0)`}>\n        {idView(datum.guid)}\n        <image\n          width={qrSize} height={qrSize}\n          x={qrSize * 0.22 / 2} y={label.width * dpi - qrSize - qrSize * 0.05}\n          xlinkHref={`data:image/svg+xml;utf8,${encodeURIComponent(datum.qr)}`}\n        />\n      </g>\n    )\n  }\n\n  return (\n    <Flex alignItems='center' flexDirection='column'>\n      <Card className='config'><Flex flexDirection='column'>\n        <form>\n          <fieldset>\n            <label>Page Size:</label>\n            <input type='number' value={page.width} onChange={setter('page', 'width')}/>\n            <span>×</span>\n            <input value={page.height} onChange={setter('page', 'height')}/>\n          </fieldset>\n          <fieldset>\n            <label>Label:</label>\n            <input value={label.width} onChange={setter('label', 'width')}/>\n            <span>×</span>\n            <input value={label.height} onChange={setter('label', 'height')}/>\n          </fieldset>\n          <fieldset>\n            <label>Outer Gutters:</label>\n            <input value={outerGutter.width} onChange={setter('outerGutter', 'width')}/>\n            <span>×</span>\n            <input value={outerGutter.height} onChange={setter('outerGutter', 'height')}/>\n          </fieldset>\n          <fieldset>\n            <label>Inner Gutters:</label>\n            <input value={innerGutter.width} onChange={setter('innerGutter', 'width')}/>\n            <span>×</span>\n            <input value={innerGutter.height} onChange={setter('innerGutter', 'height')}/>\n          </fieldset>\n        </form>\n        <Field label='Presets:'>\n          <select onChange={(evt) => {\n            const preset = presets[evt.target.value]\n            for(let prop of Object.keys(setters)) {\n              setters[prop](preset[prop])\n            }\n          }}>\n            {Object.keys(presets).map((opt, i) => <option key={i}>{opt}</option>)}\n          </select>\n        </Field>\n      </Flex></Card>\n      <Flex>\n        <svg\n          viewBox={[0, 0, page.width * dpi, page.height * dpi].join(' ')}\n          width={`${page.width}in`} height={`${page.height}in`}\n          transform={`translate(0, ${outerGutter.height * dpi})`}\n        >\n          {data.map((row, ridx) => (\n            row.map((datum, cidx) => lbl(datum, ridx, cidx))\n          ))}\n        </svg>\n      </Flex>\n   </Flex>\n  )\n}","import React, { useEffect, useState, useCallback } from 'react'\nimport { HashRouter as Router, Switch, Route } from 'react-router-dom'\nimport ConnectionBanner from '@rimble/connection-banner'\nimport { MetaMaskButton, Card, Flex } from 'rimble-ui'\nimport Web3 from 'web3'\nimport './App.css'\nimport Main from './Main'\nimport PublicJobs from './Jobs/Public'\nimport PrivateJobs from './Jobs/Private'\nimport Parcels from './Parcels'\nimport ViewParcel from './Parcels/View'\nimport Contracts from './Contracts'\nimport NewContract from './Contracts/New'\nimport Join from './Join'\nimport Overview from './Overview'\nimport Contacts from './Contacts'\nimport NewContact from './Contacts/New'\nimport EditContact from './Contacts/Edit'\nimport Labels from './Labels'\nimport Test3Box from './Test3Box'\n\nexport default () => {\n  const [currentNet, setCurrentNet] = useState()\n  const web3 = new Web3(Web3.givenProvider)\n\n  const setNet = useCallback(async () => {\n    try {\n     setCurrentNet(await web3.eth.net.getId())\n    } catch(err) {\n      console.error('App#setNet', err)\n    }\n  }, [web3.eth.net])\n\n  useEffect(() => { setNet() }, [setNet])\n\n  const mobile = (\n    /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i\n    .test(navigator.userAgent)\n  )\n\n  return (\n    <Router>\n      <ConnectionBanner currentNetwork={currentNet} requiredNetwork={4}>\n        {{\n          notWeb3CapableBrowserMessage: (\n            <Card maxWidth='25em' mx='auto' marginTop='1.5em'>\n              <Flex alignItems='center' flexDirection='column'>\n                <MetaMaskButton\n                  as='a' href='//metamask.app.link/dapp/pkg.dhappy.org'\n                  mx='auto'\n                >\n                  {mobile ? 'Launch in MetaMask' : 'Get Metamask'}\n                </MetaMaskButton>\n              </Flex>\n            </Card>\n          ),\n          noNetworkAvailableMessage: (\n            <Card maxWidth='25em' mx='auto' marginTop='1.5em'>\n              <Flex alignItems='center' flexDirection='column'>\n                <MetaMaskButton\n                  as='a' href='//metamask.io/download.html'\n                  mx='auto'\n                >\n                  {mobile ? 'Launch in MetaMask' : 'Get Metamask'}\n                </MetaMaskButton>\n              </Flex>\n            </Card>\n          ),\n        }}\n      </ConnectionBanner>\n      <Switch>\n        <Route path='/' exact component={Main}/>\n        <Route path='/overview' component={Overview}/>\n        <Route path='/ppl/:address/edit' component={EditContact}/>\n        <Route path='/ppl/new' component={NewContact}/>\n        <Route path='/ppl' component={Contacts}/>\n        <Route path='/jobs/public' component={PublicJobs}/>\n        <Route path='/jobs/private' component={PrivateJobs}/>\n        <Route path='/cel/:guid' component={ViewParcel}/>\n        <Route path='/parcels' component={Parcels}/>\n        <Route path='/contracts/new' component={NewContract} />\n        <Route path='/contracts/:id/join' component={Join} />\n        <Route path='/contracts' component={Contracts} />\n        <Route path='/labels' component={Labels} />\n      </Switch>\n    </Router>\n  )\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import React from 'react'\nimport QrReader from 'react-qr-reader'\nimport './App.css';\n\nexport default (props) => {\n  const handleError = (err) => {\n    alert(err.message)\n  }\n\n  return (\n    <QrReader\n      delay={200}\n      onError={handleError}\n      onScan={props.onScan}\n      style={{ width: '50vw', maxHeight: '50vh' }}\n    />\n  )\n}\n","import React, { useEffect, useState, useCallback } from 'react'\nimport {\n  Map as LeafletMap, Marker, Popup, TileLayer,\n  Circle, Polyline, SVGOverlay\n} from 'react-leaflet'\nimport {\n  Text, Card, Flex, Heading, Button, Input, Table, Loader,\n  Radio, Checkbox, Icon\n} from 'rimble-ui'\nimport { HashLink as Link } from 'react-router-hash-link'\nimport gsap from 'gsap'\nimport ScrollTrigger from 'gsap/ScrollTrigger'\nimport Box from '3box'\nimport Web3 from 'web3'\nimport { v1 as uuidv1 } from 'uuid'\nimport * as base58 from 'bs58'\n//import * as sigUtil from 'eth-sig-util'\nimport IdentityWallet from 'identity-wallet'\nimport { commafy, capitalize, distanceBetween, chunk } from '../utils'\nimport QRReader from '../QRReader'\n\nexport default (props) => {\n  const [type, setType] = useState()\n  const [pos, setPos] = useState({ lat: 53, lng: 12 })\n  const [mark, setMark] = useState(pos)\n  const [r, setBoundsRadius] = useState(200)\n  const [other, setOther] = useState()\n  const [time, setTime] = useState(0)\n  const [contacts, setContacts] = useState()\n  const [bond, setBond] = useState(0)\n  const [did, setDID] = useState()\n  const [couriers, setCouriers] = useState([])\n  const [scanner, setScanner] = useState(false) // show QR code scanner\n  const web3 = new Web3(Web3.givenProvider)\n  \n  const buffer = []\n  uuidv1({}, buffer)\n  let b58 = base58.encode(buffer)\n  const [guid, setGUID] = useState(chunk(b58, 6).join('–'))\n\n  useEffect(() => {\n    ScrollTrigger.register(gsap)\n\n    // let sections = gsap.utils.toArray('.card')\n    // console.info(sections.length)\n    // gsap.to(sections, {\n    //   yPercent: -100 * (sections.length - 1),\n    //   ease: 'none',\n    //   scrollTrigger: {\n    //     trigger: '.cards',\n    //     pin: true,\n    //     scrub: 1,\n    //     snap: 1 / (sections.length - 1),\n    //     // base vertical scrolling on how wide the container is so it feels more natural.\n    //     end: () => \"+=\" + document.querySelector('.cards').offsetWidth\n    //   }\n    // });\n\n    // const tl = gsap.timeline()\n    // tl.from('.map', { xPercent: 20, width: '60%' })\n    // gsap.to(cards[1].current, {\n    //   scrollTrigger: {\n    //     trigger: cards[1].current,\n    //     // enter from bottom, leave top, enter from top, leave bottom\n    //     toggleActions: 'restart pause reverse pause',\n    //     // element top hits viewport center\n    //     start: 'top center',\n    //     end: 'bottom center',\n    //     markers: true,\n    //     scrub: true,\n    //   },\n    //   x: 300, width: '-=600', duration: 2\n    // })\n  }, [])\n\n  const loadContacts = useCallback(async () => {\n    let provider = Web3.givenProvider\n    if(!provider) {\n      provider = window.web3 && window.web3.currentProvider\n    }\n    if(!provider) {\n      throw new Error(\"Couldn't Find an Ethereum Provider.\\n\\nCan't connect to databases.\")\n    }\n    const web3 = new Web3(provider)\n    const user = (await web3.eth.getAccounts())[0]\n    const box = await Box.openBox(user, Web3.givenProvider)\n    setDID(await (await box.openSpace('courier')).DID)\n    const contacts = await box.openSpace('courier-contacts')\n    await contacts.syncDone\n    setContacts(await contacts.private.all())\n  }, [])\n\n  useEffect(() => { loadContacts() }, [loadContacts])\n\n  useEffect(() => {\n    navigator.permissions.query({name: 'geolocation'})\n    .then((result) => {\n      if(result.state === 'granted' || result.state === 'prompt') {\n        const success = (pos) => {\n          const actual = { lat: pos.coords.latitude, lng: pos.coords.longitude }\n          setPos(actual)\n          setMark(actual)\n        }\n        const error = (err) => alert(`Error Getting Current Position: '${err.message}'`)\n        navigator.geolocation.getCurrentPosition(success, error)\n      } else if(result.state === 'denied') {\n        alert(\"Couldn't Access GPS\")\n      } else {\n        alert(`Unknown GPS Code: ${result.state}`)\n      }\n    })\n  }, [])\n\n  useEffect(() => {\n    const hashchange = () => {}\n    window.addEventListener('hashchange', hashchange)\n    return () => window.removeEventListener('hashchange', hashchange)\n  }, [])\n\n  const updateType = (type) => {\n    setType(type)\n  }\n\n  const delta = { lat: mark.lat - pos.lat, lng: mark.lng - pos.lng }\n  const size = Math.sqrt(Math.pow(delta.lat, 2) + Math.pow(delta.lng, 2))\n  const textBounds = [\n    {\n      lat: pos.lat + delta.lat / 2 - 2 * size, \n      lng: pos.lng + delta.lng / 2 - 5 * size,\n    },\n    {\n      lat: pos.lat + delta.lat / 2 + 2 * size, \n      lng: pos.lng + delta.lng / 2 + 5 * size,\n    }\n  ]\n\n  const dragMarker = (evt) => {\n    setMark(evt.latlng)\n    setBoundsRadius(distanceBetween(pos, evt.latlng))\n    setTime(r / 750)\n  }\n\n  const pageIcons = ['Mail', 'Map', 'Info', 'MarkunreadMailbox', 'Dai', 'LocalTaxi', 'Save']\n  const pageDescs = [\n    'Configure whether sending or receiving.',\n    'Choose a waypoint and travel time for meeting the courier.',\n    'Set the package id.',\n    'Choose the party for the other end of your transaction.',\n    'Specify the bond you would like on the delivery.',\n    'Choose couriers to request bids from.',\n    'Review the contract and send it for completion.',\n  ]\n\n  const navbuttons = ({ idx, onBack, onNext, nextAvail = true }) => (\n    <Flex mt={25} mb={10} justifyContent='flex-end' alignItems='center' flexDirection='row'>\n      {[...new Array(pageIcons.length)].map((_, i) =>\n        <Link key={i} to={`#${i + 1}`}>\n          {i + 1 !== idx\n            ? <Button.Outline size='small' icon={pageIcons[i % pageIcons.length]}\n                title={pageDescs[i % pageDescs.length]} px={0} mx={0} mt={0}\n              />\n            : <Button size='small' icon={pageIcons[i % pageIcons.length]}\n                title={pageDescs[i % pageDescs.length]} px={0} mx={1} mt={0}\n              />\n          }\n        </Link>\n      )}\n      <Link to={`#${idx - 1}`}>\n        <Button.Outline onClick={onBack} icon='ArrowBack' mt={3} mx={1}>Back</Button.Outline>\n      </Link>\n      <Link to={`#${idx + 1}`} disabled={!nextAvail}>\n        <Button onClick={onNext} icon='ArrowForward' mt={3} mx={1} disabled={!nextAvail}>Next</Button>\n      </Link>            \n    </Flex>\n  )\n\n  const signContract = async (tract) => {\n    const Domain = [\n      { name: 'name', type: 'string' },\n      { name: 'version', type: 'string' },\n      { name: 'chainId', type: 'uint256' },\n      { name: 'salt', type: 'bytes32' },\n    ]\n    const Contract = [\n      { name: 'dropoff', type: 'AnonLocation' },\n      { name: 'pickup', type: 'AnonLocation' },\n      { name: 'bond', type: 'uint256' },\n    ]\n    const AnonLocation = [\n      { name: 'lat', type: 'int64' },\n      { name: 'lng', type: 'int64' },\n      { name: 'travelTime', type: 'uint32' },\n    ]\n\n    const salt = new Uint32Array(16)\n    window.crypto.getRandomValues(salt)\n\n    const data = {\n      domain: {\n        name: 'Courier',\n        version: '0.2.4',\n        chainId: await web3.eth.net.getId(), // 4, // Rinkeby\n        salt: 'https://pkg.dhappy.org', //'0x' + Buffer.from(salt).toString('hex'),\n      },\n      contract: tract,\n    }\n\n    const payload = {\n      types: {\n          EIP712Domain: Domain,\n          Contract,\n          AnonLocation,\n      },\n      domain: data.domain,\n      primaryType: 'Contract',\n      message: data.contract,\n    }\n\n    const user = (\n      await window.ethereum.request({ method: 'eth_requestAccounts' })\n    )[0]\n    const sig = await window.ethereum.request({\n      method: 'eth_signTypedData_v4',\n      params: [user, JSON.stringify(payload)],\n      from: user\n    })\n    payload.signatures = [sig]\n    // const signer = await sigUtil.recoverTypedSignature_v4(\n    //   { data: payload, sig }\n    // )\n    return payload\n  }\n\n  const postToInbox = async (recipient, obj) => {\n    const box = await Box.openBox(recipient, Web3.givenProvider)\n    const app = await box.openSpace('courier')\n    const inbox = await app.joinThread('inbox')\n    await inbox.post(obj)\n  }\n\n  return (\n    <Flex className='cards' flexDirection='column'>\n      <Card id='1' className='card'>\n        <Flex alignItems='center' flexDirection='column'>\n          <Heading>Which are you?</Heading>\n          <Flex flexDirection='row'>\n            <Link to='#2' onClick={() => updateType('pick-up')}>\n              <Button variant={type === 'pick-up' && 'success'} mx='0.5em'>Sender</Button>\n            </Link>\n            <Link to='#2' onClick={() => updateType('dropoff')}>\n              <Button variant={type === 'dropoff' && 'success'} mx='0.5em'>Recipient</Button>\n            </Link>\n          </Flex>\n        </Flex>\n      </Card>\n      <Card id='2' className='card map'>\n        {navbuttons({ idx: 2 })}\n        <Flex alignItems='center' flexDirection='column'>\n          <Heading>Where are you?</Heading>\n          <Text indent='1.5em' fontSize={22}>Your location is anonymized by specifying your distance from a waypoint in terms of travel time.</Text>\n          <Text indent='1.5em' fontSize={22}>Please place your waypoint within ¼ mile of a public road. Once your courier is arranged you will get a chat to orchestrate your parcel pickup. If, for whatever reason, you are unresponsive, the courier will go to the waypoint.</Text>\n          <Text indent='1.5em' fontSize={22}>If they still can't reach you they can register a wait complaint, but they have to be within ¼ mile of the waypoint.</Text>\n          <LeafletMap center={pos} zoom={11} width={0.8} style={{ margin: '1em auto' }}>\n            <TileLayer\n              url=\"https://{s}.tile.osm.org/{z}/{x}/{y}.png\"\n              attribution='&copy; <a href=\"//osm.org/copyright\">OpenStreetMap</a> contributors'\n            />\n            <Marker position={mark} draggable={true} onDrag={dragMarker}>\n              <Popup>{`${capitalize(type)} Waypoint`}</Popup>\n            </Marker>\n            <Circle center={pos} radius={r}/>\n            <Polyline positions={[pos, mark]}/>\n            <SVGOverlay bounds={textBounds}>\n              <text x=\"50%\" y=\"50%\" fill='black' fontSize={25} stroke='black' textAnchor='middle'>{time && `${time.toFixed(1)}min`}</text>\n            </SVGOverlay>\n          </LeafletMap>\n          <Flex alignItems='center' flexDirection='row'>\n            <Text mx='0.5em'>{`${capitalize(type)} Waypoint:`}</Text>\n            <Input\n              type='number'\n              value={mark.lat}\n              onChange={(evt) => {\n                const lat = (\n                  evt.target.value !== '' ? parseFloat(evt.target.value) : pos.lat\n                )\n                dragMarker({ latlng: {...mark, lat } })\n              }}\n            />\n            <Text fontSize='200%'>×</Text>\n            <Input\n              type='number'\n              value={mark.lng}\n              onChange={(evt) => {\n                const lng = (\n                  evt.target.value !== '' ? parseFloat(evt.target.value) : pos.lng\n                )\n                dragMarker({ latlng: {...mark, lng } })\n              }}\n            />\n          </Flex>\n          <Flex alignItems='center' flexDirection='row' mt={3}>\n            <Text mx='0.5em'>\n              {`Time to ${type === 'pick-up' ? 'Sender' : 'Recipient'}:`}\n            </Text>\n            <Input\n              width='4em'\n              type='number'\n              value={Math.ceil(time || 0)}\n              onChange={(evt) => {\n                const when = (\n                  evt.target.value !== '' ? parseFloat(evt.target.value) : time\n                )\n                setTime(when)\n              }}\n            />\n            <Text>minute{time === 1 ? '' : 's'}</Text>\n          </Flex>\n        </Flex>\n      </Card>\n      <Card id='3' className='card'>\n        {navbuttons({ idx: 3 })}\n        <Flex alignItems='center' flexDirection='column'>\n          <Heading>What is the package id?</Heading>\n          <Text fontSize={22}>Every parcel in the network has a unique identifier that should be <Link to='/labels'>scannable as a QR code</Link> or NFC tag. Barring that, the id should be written on the package.</Text>\n          <Flex alignItems='center' flexDirection='row'>\n            <Input width='35ch' value={guid} textAlign='center' onChange={evt => setGUID(evt.target.value)} />\n            <Button icon='Pages' title='Scan QR Code' onClick={() => setScanner(true)}/>\n          </Flex>\n          {scanner &&\n            <Card>\n              <QRReader onScan={(data) => {\n                if(data) {\n                  const match = data.match(/^(https?:)?\\/\\/pkg.dhappy.org\\/(#\\/)?cel\\/([^/]+)/i)\n                  if(match) {\n                    setGUID(match[3])\n                    setScanner(false)\n                  }\n                }\n              }}/>\n            </Card>\n          }\n        </Flex>\n      </Card>\n      <Card id='4' className='card'>\n        {navbuttons({ idx: 4 })}\n        <Flex alignItems='center' flexDirection='column'>\n          <Heading>Who are you {type === 'pick-up' ? 'sending it to' : 'getting it from'}?</Heading>\n          {!contacts\n            ? <>\n              <Heading>Loading Contacts</Heading>\n              <Loader/>\n            </>\n            :(\n              <Table>\n                <thead><tr><th>Select</th><th>Names</th></tr></thead>\n                <tbody>\n                  {Object.entries(contacts).map(([addr, contact]) => (\n                    <tr key={addr} style={{ cursor: 'pointer' }}>\n                      <td><Radio checked={other === contact}\n                        onChange={(evt) => {\n                          // Is getting called twice\n                          setOther((other) => {\n                            console.info(other, contact, other === contact)\n                            return other !== contact ? contact : null\n                          })\n                        }}\n                      /></td>\n                      <td onClick={() => setOther(contact)}>{commafy(contact.names)}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </Table>\n            )\n          }\n        </Flex>\n      </Card>\n      <Card id='5' className='card'>\n        {navbuttons({ idx: 5 })}\n        <Flex alignItems='center' flexDirection='column'>\n          <Heading>What bond do you want on the delivery?</Heading>\n          <Text indent='1.5em' fontSize={22}>Couriers stake a bond as insurance for their good faith. If your courier fails to check in at a waypoint or receive a delivery receipt, this is the what you get to cover your loss.</Text>\n          <Flex alignItems='center' flexDirection='row'>\n            <Input\n              my={3}\n              type='number'\n              value={bond}\n              onChange={(evt) => {\n                const bond = (\n                  evt.target.value !== '' ? parseFloat(evt.target.value) : 0\n                )\n                if(bond < 0) bond *= -1\n                setBond(bond)\n              }}\n            />\n            <Text ml={2}><Icon name='Dai'/> DAI</Text>\n          </Flex>\n        </Flex>\n      </Card>\n      <Card id='6' className='card'>\n        {navbuttons({ idx: 6 })}\n        <Flex alignItems='center' flexDirection='column'>\n          <Heading>Choose Couriers</Heading>\n          <Text indent='1.5em' fontSize='15pt'>These couriers will be notified of your contract and given an opportunity to bid.</Text>\n          {!contacts\n            ? <>\n              <Heading>Loading Contacts</Heading>\n              <Loader/>\n            </>\n            :(\n              <Table>\n                <thead><tr><th>Select</th><th>Names</th></tr></thead>\n                <tbody>\n                  {Object.entries(contacts).map(([addr, contact]) => (\n                    <tr key={addr}>\n                      <td><Checkbox checked={couriers.includes(contact)}\n                        onChange={(evt) => {\n                          if(evt.target.checked) {\n                            setCouriers(cs => [...new Set([...cs, contact])])\n                          } else {\n                            setCouriers(cs => cs.filter(c => c !== contact))\n                          }\n                        }}\n                      /></td>\n                      <td onClick={(evt) => {\n                        setCouriers(cs => {\n                          if(cs.includes(contact)) {\n                            return cs.filter(c => c !== contact)\n                          } else {\n                            return [...new Set([...cs, contact])]\n                          }\n                        })\n                      }}>{commafy(contact.names)}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </Table>\n            )\n          }\n        </Flex>\n      </Card>\n      <Card id='7' className='card'>\n        {navbuttons({ idx: 7, nextAvail: type !== undefined,\n          onNext: async (evt) => {\n            let provider = Web3.givenProvider\n            if(!provider) {\n              provider = window.web3 && window.web3.currentProvider\n            }\n            if(!provider) {\n              throw new Error(\"Couldn't Find an Ethereum Provider.\\n\\nCan't connect to databases.\")\n            }\n            const web3 = new Web3(provider)\n            const user = (await web3.eth.getAccounts())[0]\n                  const box = await Box.openBox(user, Web3.givenProvider)\n            const parcels = await box.openSpace('courier')\n            await parcels.waitSync\n            const guidBytes = base58.decode(guid.replace(/-/g, ''))\n            const digest = await crypto.subtle.digest('SHA-256', guidBytes)\n            const hash = base58.encode(Buffer.from(digest))\n            const threadName = `bids-${hash}`\n            const thread = await parcels.createConfidentialThread(threadName)\n            const contract = {\n              bond: (bond || 0) * Math.pow(10, 18),\n              [type]: {\n                contact: did,\n                lat: Math.round(mark.lat * Math.pow(10, 6)),\n                lng: Math.round(mark.lng * Math.pow(10, 6)),\n                travelTime: Math.round(time * 60),\n              },\n            }\n            console.info('TCT', contract)\n            await thread.post({ contract })\n            await thread.addMember(other.address)\n            const creator = user\n            await postToInbox(other.address, { awaiting: thread.address, creator })\n            for(let courier of couriers) {\n              await thread.addMember(courier.address)\n              await postToInbox(courier.address, { contract: thread.address, creator })\n              console.info(courier)\n            }\n            const posts = await thread.getPosts()\n            console.info(posts)\n          }\n        })}\n        <Flex alignItems='center' flexDirection='column'>\n          <Heading>Get {type === 'pick-up' ? 'Recipient' : 'Sender'} Information</Heading>\n          {!type\n            ? <Text fontSize={22}>You need to specify <Link to='#1'>whether you are sending or receiving</Link>.</Text>\n            : (!other\n              ? <Text fontSize={22}>You have not <Link to='#4'>selected the other party</Link>.</Text>\n              : <Text fontSize={22}>The contract will now be sent to {other.names[0]} for their location information. {couriers.length > 0 && 'Links to the bidding database will be sent to the following couriers for bids:'}</Text>\n            )\n          }\n        </Flex>\n        {type && other &&\n          <Flex alignItems='start' flexDirection='column'>\n            <ul>\n              {couriers.map((c, i) => <li key={i}>{commafy(c.names)}</li>)}\n            </ul>\n          </Flex>\n        }\n      </Card>\n    </Flex>\n  )\n}","export const commafy = (list) => {\n  const len = list.length\n  if(len === 0 || len === 1) {\n    return list[0]\n  } else if(len === 2) {\n    return `${list[0]} & ${list[1]}}`\n  } else {\n    return [\n      list.slice(0, len - 1).join(', '),\n      list.slice(-1)[0]\n    ].join(', & ')\n  }\n}\n\nexport const capitalize = (word) => (\n  (word || '').split('-')\n  .map(p => ((p[0] && p[0].toUpperCase()) || '') + p.slice(1))\n  .join('-')\n)\n\n// https://stackoverflow.com/a/43208163\nexport const toRadian = degree => degree * Math.PI / 180\nexport const distanceBetween = (origin, destination) => {\n  const p = {\n    1: { lat: toRadian(origin.lat), lng: toRadian(origin.lng) },\n    2: { lat: toRadian(destination.lat), lng: toRadian(destination.lng) },\n  }\n  const delta = { lat: p[2].lat - p[1].lat, lng: p[2].lng - p[1].lng }\n  const a = (\n    Math.pow(Math.sin(delta.lat / 2), 2)\n    + Math.cos(p[1].lat) * Math.cos(p[2].lat)\n    * Math.pow(Math.sin(delta.lng / 2), 2)\n  )\n  const c = 2 * Math.asin(Math.sqrt(a))\n  const EARTH_RADIUS = 6371000 // meters\n  return c * EARTH_RADIUS\n}\n\nexport const chunk = (from, size) => {\n  const isStr = typeof(from) === 'string'\n  let arr = Array.from(from)\n  let to = []\n  while(arr.length) {\n    const nxt = arr.splice(0, size)\n    to.push(isStr ? nxt.join('') : nxt)\n  }\n  return to\n}"],"sourceRoot":""}