(this.webpackJsonpCourier=this.webpackJsonpCourier||[]).push([[0],{1032:function(e,t){},1034:function(e,t){},1040:function(e,t){},1127:function(e,t){},1306:function(e,t){},1360:function(e,t){},1369:function(e,t){},1371:function(e,t){},1493:function(e,t){},1545:function(e,t){},1566:function(e,t){},1568:function(e,t){},1599:function(e,t){},1828:function(e,t){},1890:function(e,t){},1907:function(e,t){},1909:function(e,t){},1959:function(e,t){},2071:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(145),l=a.n(c),o=(a(873),a(3)),i=a.n(o),u=a(23),s=a(21),m=a(100),d=a(74),f=a(840),p=a.n(f),h=a(175),b=a(106),E=a(2088),g=a(48),v=a.n(g),x=(a(388),a(38)),j=a(136),O=a(162),w=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.b,{maxWidth:"45em",mx:"auto",marginTop:"1.5em",px:[3,3,4]},r.a.createElement(h.a,null,r.a.createElement(b.a,{flexDirection:"column"},r.a.createElement("h1",null,"The ",r.a.createElement("acronym",{title:"Department of Happiness"},"DoH"),"'s Ad Hoc Courier Service"),r.a.createElement(m.Link,{to:"/overview",style:{alignSelf:"center"}},r.a.createElement(j.a,{mainColor:"DarkCyan"},"Overview"))))),r.a.createElement(x.b,null,r.a.createElement(h.a,{maxWidth:"25em",mx:"auto",marginTop:"1.5em",px:[3,3,4]},r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(O.a,null,"Anyone"),r.a.createElement(m.Link,{to:"/ppl"},r.a.createElement(j.a,{mx:"auto",my:"0.5em"},"Manage Contacts")),r.a.createElement(m.Link,{to:"/labels"},r.a.createElement(j.a,{mx:"auto",my:"0.5em"},"Print Labels")))),r.a.createElement(h.a,{maxWidth:"25em",mx:"auto",marginTop:"1.5em"},r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(O.a,null,"Couriers"),r.a.createElement(m.Link,{to:"/jobs/public"},r.a.createElement(j.a,{mx:"auto",my:"0.5em"},"Find Public Jobs")),r.a.createElement(m.Link,{to:"/jobs/private"},r.a.createElement(j.a,{mx:"auto",my:"0.5em"},"Check Private Jobs")),r.a.createElement(m.Link,{to:"/parcels"},r.a.createElement(j.a,{mx:"auto",my:"0.5em"},"Investigate Parcels")),r.a.createElement(m.Link,{to:"/drive"},r.a.createElement(j.a,{mx:"auto",my:"0.5em"},"Drive")))),r.a.createElement(h.a,{maxWidth:"25em",mx:"auto",marginTop:"1.5em",px:[3,3,4]},r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(O.a,null,"Shippers"),r.a.createElement(m.Link,{to:"/contracts/new"},r.a.createElement(j.a,{mx:"auto",my:"0.5em"},"Ship a Parcel"))))))},k=a(39),y=a(80),C=a(2081),S=a(2082),D=a(2085),P=a(2075),M=a(2083),I=a(2086),A=a(863),T=a(865),B=a(2090),L=a(2084),G=a(866),F=a(2087),N=a(203),z=a(61),R=a.n(z),W=(a(2003),a(97)),H="0xC33290860C1DA6a84195C5cf1575860d3A3ED73d",q=function(){var e=Object(n.useState)({lat:-.09,lng:51.505}),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)([]),o=Object(s.a)(l,2),m=o[0],d=o[1],f=Object(n.useState)([]),p=Object(s.a)(f,2),E=p[0],g=p[1],x=Object(n.useState)(),w=Object(s.a)(x,2),z=w[0],q=w[1],U=Object(n.useState)({}),_=Object(s.a)(U,2),J=_[0],Y=_[1],Q=Object(n.useState)(),V=Object(s.a)(Q,2),Z=V[0],$=V[1],K=new v.a(v.a.givenProvider);Object(n.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){return c({lat:e.coords.latitude,lng:e.coords.longitude})}),(function(e){return alert("Error Getting Current Position: '".concat(e.message,"'"))}))}),[]);var X=Object(n.useCallback)(Object(u.a)(i.a.mark((function e(){var t,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(O.a,null,e),t&&r.a.createElement(T.a,{size:"80px"}))},e.prev=1,q(t("Loading Profile\u2026",!0)),e.next=5,window.ethereum.request({method:"eth_requestAccounts"});case 5:return a=e.sent[0],q(t(r.a.createElement(B.a,{message:a,placement:"bottom"},r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(O.a,null,"Researching"),r.a.createElement(L.a,{opts:{seed:a,size:50}}))),!0)),e.next=9,R.a.openBox(a,v.a.givenProvider);case 9:return n=e.sent,q(t("Opened Box\u2026",!0)),e.next=13,n.syncDone;case 13:return q(t("Getting Name\u2026",!0)),e.next=16,Promise.all([Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=q,e.t1=t,e.t2="Welcome ",e.next=5,n.public.get("name");case 5:return e.t3=e.sent,e.t4=e.t2.concat.call(e.t2,e.t3),e.t5=(0,e.t1)(e.t4),e.abrupt("return",(0,e.t0)(e.t5));case 9:case"end":return e.stop()}}),e)})))(),Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.a.getSpace(H,"courier-zones");case 2:if(t=e.sent,0!==Object.keys(t).length){e.next=11;break}if(a.toLowerCase()!==H.toLowerCase()){e.next=10;break}return e.next=7,n.openSpace("courier-zones");case 7:t=e.sent,e.next=11;break;case 10:alert("Couldn't find the thread manager.");case 11:$(t);case 12:case"end":return e.stop()}}),e)})))()]);case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(1),alert("Error Connecting to 3Box: '".concat(e.t0.message,"'")),q(t("Loading Failed"));case 22:case"end":return e.stop()}}),e,null,[[1,18]])}))),[]);Object(n.useEffect)((function(){X()}),[X]);var ee=Object(n.useCallback)(function(){var e=Object(u.a)(i.a.mark((function e(t){var a,n,r,c,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Z){e.next=25;break}a=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="contract"===t.type,!e.t0){e.next=7;break}return e.next=4,K.eth.getBlockNumber();case 4:e.t1=e.sent,e.t2=t.expires,e.t0=e.t1<=e.t2;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n={},r=Object(y.a)(t),e.prev=4,r.s();case 6:if((c=r.n()).done){e.next=16;break}if((l=c.value).addr){e.next=12;break}return e.next=11,Z.public.get("zone-db-".concat(l.id));case 11:l.addr=e.sent;case 12:if(!l.addr){e.next=14;break}return e.delegateYield(i.a.mark((function e(){var t,r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.joinThreadByAddress(l.addr);case 2:return t=e.sent,e.next=5,t.getPosts();case 5:return r=e.sent,e.next=8,Promise.all(r.map(a));case 8:c=e.sent,n[l.id]=r.filter((function(e,t){return c[t]}));case 10:case"end":return e.stop()}}),e)}))(),"t0",14);case 14:e.next=6;break;case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(4),r.e(e.t1);case 21:return e.prev=21,r.f(),e.finish(21);case 24:Y(n);case 25:case"end":return e.stop()}}),e,null,[[4,18,21,24]])})));return function(t){return e.apply(this,arguments)}}(),[Z]);Object(n.useEffect)((function(){ee(E)}),[ee,E]),Object(n.useEffect)((function(){var e=.015,t=2*Math.PI/6,n=Math.floor(a.lng/.03),r=Math.floor(a.lat/(.03*Math.sin(t))),c=.03*Math.sin(t),l=.03,o=35*c,i=12*l,u=Object(k.a)(new Array(420)).map((function(u,s){var m=Math.floor(s/12),d={x:a.lng+1*m*e*Math.sin(t)-(o/4-c/2),y:a.lat+s%12*3*e-(3*i/4+l/2)};m%2===1&&(d.y+=3*e*Math.cos(t));var f=[[d.y-e,d.x],[d.y-e*Math.cos(t),d.x+e*Math.sin(t)],[d.y+e*Math.cos(t),d.x+e*Math.sin(t)],[d.y+e,d.x],[d.y+e*Math.cos(t),d.x-e*Math.sin(t)],[d.y-e*Math.cos(t),d.x-e*Math.sin(t)]];return f.center={lat:d.y,lng:d.x},f.index={row:n+m,col:r+s%35},f.id="(".concat(f.index.row,",").concat(f.index.col,")"),f.contracts=[],f}));d(u);var s=u.filter((function(e){return e.every((function(e){return Math.sqrt(Math.pow(e[1]-a.lng,2)+Math.pow(e[0]-a.lat,2))<=.15}))}));g(s)}),[a]);var te=console.info,ae=console.info;return r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},z&&r.a.createElement(h.a,null,r.a.createElement(O.a,null,z)),r.a.createElement(O.a,null,"#1. Select Your Availability Zone"),r.a.createElement(C.a,{center:a,zoom:11},r.a.createElement(S.a,{url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),r.a.createElement(D.a,null,r.a.createElement(A.a,{position:"topleft",onDrawStart:function(e){console.info("DSTRT",e)},onDrawStop:function(e){console.info("DSTP",e)},onCreated:te,onDeleted:ae,draw:{polyline:!1,polygon:!1,marker:!1,rectangle:!1,circlemarker:!1,circle:{shapeOptions:{color:"#FF0000AA"}}}})),r.a.createElement(P.a,{position:a},r.a.createElement(M.a,null,"You are here.")),m.map((function(e,t){return r.a.createElement(I.a,{key:t,color:E.includes(e)?e.addr?"#048A0999":"#FF7B0099":"#AF05F722",positions:e,onClick:function(){g((function(t){return!t.includes(e)?[e].concat(Object(k.a)(t)):t.filter((function(t){return t!==e}))}))}})}))),r.a.createElement(G.a,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Zone ID"),r.a.createElement("th",null,"# of Open Contracts"),r.a.createElement("th",null,"\ud83d\udd4a to Center"))),r.a.createElement("tbody",null,E.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,e.id),r.a.createElement("td",null,e.contracts.length),r.a.createElement("td",null,(Object(W.d)(a,e.center)/1e3).toFixed(2),"km"))})))),r.a.createElement(G.a,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"\ud83d\udd4a to Pickup Waypoint"),r.a.createElement("th",null,"Waypoint to Sender"),r.a.createElement("th",null,"\ud83d\udd4a Pickup to Dropoff Waypoint"),r.a.createElement("th",null,"Waypoint to Recipient"),r.a.createElement("th",null,"Bid"))),r.a.createElement("tbody",null,E.map((function(e){return(J[e.id]||[]).map((function(t){return r.a.createElement("tr",{id:e.id,key:e.id},r.a.createElement("td",null,t.pickup.waypoint),r.a.createElement("td",null,t.pickup.travelTime),r.a.createElement("td",null,t.dropoff.waypoint+t.pickup.waypoint),r.a.createElement("td",null,t.dropoff.travelTime),r.a.createElement("td",null,r.a.createElement(F.a,{onSubmit:alert},r.a.createElement(N.a,{type:"number",name:"bid"}),r.a.createElement(j.a,null,"Bid"))))}))})))))},U=(a(483),a(2044),a(102)),_=function(){var e=Object(u.a)(i.a.mark((function e(t,a){var n,r,c,l,o,u,s,m;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.space,r=a.onUpdate,e.next=3,n.joinThreadByAddress(t);case 3:return c=e.sent,r&&c.onUpdate(console.log),e.next=7,c.getPosts();case 7:l=e.sent,o={},u=Object(y.a)(l);try{for(u.s();!(s=u.n()).done;)m=s.value,o[m.author]=Object(U.a)({id:m.postId},m.message)}catch(i){u.e(i)}finally{u.f()}return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),J=function(){var e=Object(n.useState)({text:"Initializing\u2026",color:"blue"}),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)([]),o=Object(s.a)(l,2),m=o[0],d=o[1],f=function(e,t){return c({text:e,color:t})},p=Object(n.useCallback)(Object(u.a)(i.a.mark((function e(){var t,a,n,r,c,l,o,u,s,m,p,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(t=v.a.givenProvider)||(t=window.web3&&window.web3.currentProvider),t){e.next=5;break}throw new Error("Couldn't Find an Ethereum Provider.\n\nCan't connect to databases.");case 5:return a=new v.a(t),console.info("ACCT",a.eth.accounts.create()),f("Getting Address\u2026","pink"),e.next=10,a.eth.getAccounts();case 10:return n=e.sent[0],f("Opening 3Box: ".concat(n,"\u2026"),"orange"),e.next=14,R.a.openBox(n,t);case 14:return r=e.sent,f("Got 3Box\u2026","green"),e.next=18,r.openSpace("courier");case 18:return c=e.sent,f("Got Courier Space\u2026","blue"),e.next=22,c.joinThread("inbox");case 22:return l=e.sent,f("Got Inbox Thread\u2026","red"),20,e.next=27,l.getPosts({limit:20});case 27:o=e.sent,f("Got ".concat(o.length," Entr").concat(1===o.length?"y":"ies","\u2026"),"blue"),u=Object(y.a)(o),e.prev=30,u.s();case 32:if((s=u.n()).done){e.next=41;break}if(m=s.value,p=m.message,h=m.author,m.timestamp,m.postId,!p.awaiting){e.next=38;break}return e.delegateYield(i.a.mark((function e(){var a,n,r,c,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.a.getConfig(h);case 2:return a=e.sent,f("Getting 3Box\u2026","green"),e.next=6,R.a.openBox(a.links[0].address,t);case 6:return n=e.sent,f("Got 3Box.","green"),e.next=10,n.openSpace("courier");case 10:return r=e.sent,f("Got Parcels Space\u2026","blue"),e.next=14,_(p.awaiting,{space:r,onUpdate:function(){console.info("UPDT")}});case 14:return c=e.sent,l=Object.keys(c).length,f("Got ".concat(l," Author").concat(1===l?"":"s","\u2026"),"blue"),d((function(e){return[c].concat(Object(k.a)(e))})),e.t0=console,e.next=21,n._3id.signJWT({payload:"test"},{space:"courier"});case 21:e.t1=e.sent,e.t0.info.call(e.t0,e.t1);case 23:case"end":return e.stop()}}),e)}))(),"t0",36);case 36:e.next=39;break;case 38:p.contract?console.info("CTCT",p):console.error("Unknown Inbox Post Type",p);case 39:e.next=32;break;case 41:e.next=46;break;case 43:e.prev=43,e.t1=e.catch(30),u.e(e.t1);case 46:return e.prev=46,u.f(),e.finish(46);case 49:e.next=55;break;case 51:e.prev=51,e.t2=e.catch(0),console.error(e.t2),alert(e.t2.message);case 55:f("Done");case 56:case"end":return e.stop()}}),e,null,[[0,51],[30,43,46,49]])}))),[]);return Object(n.useEffect)((function(){p()}),[p]),r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(O.a,null,"Private Jobs"),a&&r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(O.a,null,a.text),a.color&&r.a.createElement(T.a,{color:a.color})),m.map((function(e,t){return r.a.createElement(h.a,{key:t},JSON.stringify(e))})))},Y=a(856),Q=a(173),V=a(356),Z=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(),o=Object(s.a)(l,2),i=o[0],u=o[1],m=Object(d.k)();return r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},a?r.a.createElement(V.a,{onScan:function(e){if(e){u(e);var t=e.match(/^https?:\/\/(pkg|sw).dhappy.org(\/cel\/([^/]*)(\/(.+))?$)/);console.info(e,t),t&&(c(!1),u(t[3]),"pkg"===t[1]?m.push(t[2]):window.location=t[0])}}}):r.a.createElement(Y.a,{label:"Package ID"},r.a.createElement(b.a,{alignItems:"center",flexDirection:"row"},r.a.createElement(N.a,{type:"text",required:!0,width:"20em",placeholder:"128 bits base58 encoded",value:i,onChange:function(e){return u(e.target.value)}}),r.a.createElement(B.a,{message:"Read QR Code"},r.a.createElement(j.a,{onClick:function(){return c(!0)}},r.a.createElement(Q.a,{name:"Pages"}))))))},$=a(96),K=function(e){var t=Object(n.useState)(!1),a=Object(s.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)([]),m=Object(s.a)(o,2),d=m[0],f=m[1],p=function(e){return f((function(t){return[].concat(Object(k.a)(t),[e])}))},h=Object(n.useCallback)(function(){var e=Object(u.a)(i.a.mark((function e(t){var a,n,r,c,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.next=3,window.ethereum.request({method:"eth_requestAccounts"});case 3:return a=e.sent[0],p("Got Address: ".concat(a)),e.next=7,R.a.openBox(a,v.a.givenProvider);case 7:return n=e.sent,p("Awaiting 3Box\u2026"),e.next=11,n.waitSync;case 11:return p("Got 3Box\u2026"),e.next=14,n.openSpace("courier-parcels");case 14:return r=e.sent,p("Got Courier Space\u2026"),e.next=18,r.joinThread("thread-".concat(t));case 18:return c=e.sent,p("Got ".concat(t," Thread\u2026")),10,e.next=23,c.getPosts({limit:10});case 23:o=e.sent,p("Got ".concat(o.length," Entr").concat(1===o.length?"y":"ies","\u2026")),l(!1);case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(n.useEffect)((function(){h(e.match.params.guid)}),[]),r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(O.a,null,"Package Viewer"),r.a.createElement(O.a,null,e.match.params.guid),c&&r.a.createElement(T.a,null),r.a.createElement("ul",null,d.map((function(e,t){return r.a.createElement("li",{key:t},e)}))))},X=function(){return r.a.createElement("h1",null,"Contracts")},ee=a(859),te=function(){return r.a.createElement("h1",null,"Join")},ae=function(){var e=Object(n.useState)(),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(),o=Object(s.a)(l,2),i=o[0],u=o[1],m=Object(n.useState)("1em"),d=Object(s.a)(m,2),f=d[0],p=d[1],h=Object(n.useRef)(null),b={Grower:r.a.createElement("p",null,"Produces the raw materials for production of the substance."),Supplier:r.a.createElement("p",null,"Processes the raw materials into a consumable form."),Supply:r.a.createElement("p",null,"The final product is a large quantity of the consumable."),Unboxing:r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"The plug receives a part of the supply and measures the amount received."),r.a.createElement("p",null,r.a.createElement("i",null,"This is recorded for potential disputes with the supplier."))),Testing:r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"The plug performs available tests on the supply."),r.a.createElement("p",null,r.a.createElement("i",null,"This is recorded for the customer and supplier."))),Packaging:r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"The plug divides the supply into smaller units."),r.a.createElement("p",null,r.a.createElement("i",null,"Each packaging is recorded for inclusion in the inventory."))),Bundling:r.a.createElement("p",null,"Packages are labeled with GUIDs and gathered in a locked bundle."),Drop:r.a.createElement("p",null,"A courier picks up the bundle."),Rideshare:r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Customers select their pick-up and destination areas.")),Shopping:r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"On an in-car tablet, they communicate with a plug as to inventory."),r.a.createElement("p",null,r.a.createElement("i",null,"The shop includes the testing and packaging recordings for each parcel."))),Payment:r.a.createElement("p",null,"Payment for a parcel is transmitted via IOTA."),Fulfillment:r.a.createElement("p",null,"The courier gives the customer their purchase.")};Object(n.useEffect)((function(){h.current.addEventListener("load",(function(){var e=h.current.contentDocument.querySelector("svg");e||alert("Couldn't find SVG.");var t=e.querySelectorAll("[*|label='Icons'] > *");console.info(t),t&&0!==t.length||alert("Couldn't find nodes.");var a,n=Object(y.a)(t);try{var r=function(){var e=a.value,t=e.getAttributeNS("http://www.inkscape.org/namespaces/inkscape","label"),n=void 0,r=0;for(var l in b){if(n=b[l],l===t)break;r++}r===Object.keys(b).length&&(n=void 0);var o="20em",i=Math.floor(r/3);switch(i){case 0:o="30%";break;case 1:o="15%";break;case 2:o="25em";break;case 3:o="65%";break;default:o="".concat(25*i,"em")}e.addEventListener("mouseover",(function(){n?(u(t),c(n),p(o)):alert("Couldn't Find: ".concat(t))}),!0),e.addEventListener("mouseout",(function(){u(void 0),c(void 0)}),!0)};for(n.s();!(a=n.n()).done;)r()}catch(l){n.e(l)}finally{n.f()}}),!0)}),[]);return r.a.createElement(r.a.Fragment,null,a&&r.a.createElement("div",{onClick:function(){c(void 0)},style:{textAlign:"center",padding:"1em",left:0,right:0,position:"absolute",margin:"auto",maxWidth:"45em",top:f,backgroundColor:"yellow",border:"2px solid black",borderRadius:"1.5em"}},r.a.createElement("h1",null,i),a),r.a.createElement("object",{id:"chain",data:"chain.svg",ref:h,style:{display:"block",maxWidth:"45em",margin:"auto"}}))},ne=a(63),re=a(2091),ce=a(2089),le=function(){var e=Object(n.useState)(),t=Object(s.a)(e,2),a=(t[0],t[1]),c=Object(n.useState)(""),l=Object(s.a)(c,2),o=l[0],m=l[1],d=Object(n.useState)(),f=Object(s.a)(d,2),p=f[0],E=f[1],g=Object(n.useState)(),w=Object(s.a)(g,2),k=w[0],C=w[1],S=Object(n.useState)(),D=Object(s.a)(S,2),P=D[0],M=D[1],I=Object(n.useState)(),A=Object(s.a)(I,2),B=A[0],L=A[1],F=Object(n.useState)(!1),z=Object(s.a)(F,2),H=z[0],q=z[1],_=Object(n.useRef)(null),J=Object(n.useRef)(null),Y=function(){var e=Object(u.a)(i.a.mark((function e(){var t,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(t=v.a.givenProvider)||(t=window.web3&&window.web3.currentProvider),t){e.next=5;break}throw new Error("Couldn't Find an Ethereum Provider.\n\nCan't connect to databases.");case 5:return a=new v.a(t),e.next=8,a.eth.getAccounts();case 8:return n=e.sent[0],E(n),e.t0=C,e.next=13,R.a.openBox(n,a.currentProvider);case 13:e.t1=e.sent,(0,e.t0)(e.t1),e.next=20;break;case 17:e.prev=17,e.t2=e.catch(0),alert(e.t2.message);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){Y()}),[]);var V=function(){var e=Object(u.a)(i.a.mark((function e(){var t,a,n,r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k){e.next=17;break}return e.next=3,k.openSpace("courier-contacts");case 3:return t=e.sent,e.next=6,t.syncDone;case 6:return L(t),e.next=9,t.private.all();case 9:return a=e.sent,M(a),n="[".concat(Object.keys(a).map((function(e){return'"'.concat(e,'"')})).join(","),"]"),r="{ profiles(ids: ".concat(n,") { name eth_address image } }"),e.next=15,R.a.profileGraphQL(r);case 15:c=e.sent.profiles,M((function(e){var t,a=Object(U.a)({},e),n=Object(y.a)(c);try{for(n.s();!(t=n.n()).done;){var r=t.value;a[r.eth_address].image=r.image,a[r.eth_address].name3=r.name}}catch(l){n.e(l)}finally{n.f()}return a}));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){V()}),[k]);var Z=function(){try{var e=window.getSelection(),t=document.createRange();t.selectNodeContents(_.current),e.removeAllRanges(),e.addRange(t),document.execCommand("copy"),e.removeAllRanges(),J.current.addMessage("Copied to Clipboard",{secondaryMessage:"URL is ready to paste\u2026",variant:"default",icon:"Assignment"})}catch(a){alert(a.message)}};return r.a.createElement(b.a,{alignItems:"center",flexDirection:"column",position:"relative"},r.a.createElement(O.a,null,"Contacts"),r.a.createElement(j.a,{onClick:function(){return q(!0)},icon:"Share",position:"absolute",top:0,right:0,mt:3,mr:3,title:"Invite Contacts"}),r.a.createElement(re.a,{isOpen:H},r.a.createElement(h.a,{p:0},r.a.createElement(j.a.Text,{icononly:!0,icon:"Close",color:"moon-gray",position:"absolute",top:0,right:0,mt:3,mr:3,onClick:function(){return q(!1)},title:"Close"}),r.a.createElement(x.b,{p:4,mb:3},r.a.createElement(O.a,null,"Invitation Link"),function(){var e="/ppl/new?alias=".concat(encodeURI(o),"&address=").concat(p),t="https://pkg.dhappy.org/#".concat(e);return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{placeholder:"What do they call you?",value:o,onChange:function(e){return m(e.target.value)}}),o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ne.a,null,"To invite contacts, send them this:"),r.a.createElement(b.a,{alignItems:"center",justifyContent:"center",flexDirection:"row"},r.a.createElement($.HashLink,{to:e,ref:_,style:{overflow:"hidden",textOverflow:"ellipsis"}},t),r.a.createElement(j.a,{onClick:Z,title:"Copy to Clipboard",mx:2,size:"small"},r.a.createElement(Q.a,{name:"Assignment"})))))}()),r.a.createElement(b.a,{px:4,py:3,borderTop:1,borderColor:"#E8E8E8",justifyContent:"flex-end"},r.a.createElement(j.a,{onClick:function(){a(),q(!1)}},"Done")))),P?0===Object.keys(P).length?r.a.createElement(O.a,null,"No Contacts"):r.a.createElement(G.a,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Avatar"),r.a.createElement("th",null,"Names"),r.a.createElement("th",null,"3Box Name"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,Object.entries(P).map((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];return r.a.createElement("tr",{key:a},r.a.createElement("td",null,n.image&&r.a.createElement("img",{className:"avatar",src:"//ipfs.io/ipfs/".concat(n.image)})),r.a.createElement("td",{title:"Public Key: ".concat(n.key)},Object(W.c)(n.names)),r.a.createElement("td",null,r.a.createElement("a",{href:"//3box.io/".concat(a),target:"_blank",title:"3Box Profile"},n.name3)),r.a.createElement("td",null,r.a.createElement($.HashLink,{to:"/contacts/".concat(a,"/edit")},r.a.createElement(j.a,{icon:"Edit",mx:1},"Edit")),r.a.createElement(j.a,{variant:"danger",icon:"Delete",mx:1,onClick:function(){window.confirm("Really Delete: ".concat(Object(W.c)(n.names),"?"))&&(B.private.remove(a),M((function(e){var t=Object(U.a)({},e);return delete t[a],t})))}},"Delete")))})))):r.a.createElement(h.a,null,r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(ne.a,null,"Loading Contacts"),r.a.createElement(T.a,{size:"large",mt:3}))),r.a.createElement(ce.a.Provider,{ref:J}))},oe=function(){var e=new URLSearchParams(Object(d.l)().search),t=Object(n.useState)([e.get("alias")]),a=Object(s.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(e.get("address")),m=Object(s.a)(o,1)[0],f=Object(n.useState)(),p=Object(s.a)(f,2),E=p[0],g=p[1],x=Object(n.useState)(),w=Object(s.a)(x,2),y=w[0],C=w[1],S=Object(n.useState)(),D=Object(s.a)(S,2),P=D[0],M=D[1],I=Object(n.useState)(r.a.createElement(T.a,{display:"inline",title:"Opening 3Box\u2026"})),A=Object(s.a)(I,2),B=A[0],L=A[1],G=Object(n.useState)("Save"),F=Object(s.a)(G,2),z=F[0],W=F[1],H=v.a.givenProvider;H||(H=window.web3&&window.web3.currentProvider);var q=new v.a(H),U=Object(n.useCallback)(Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,q.eth.getAccounts();case 3:return t=e.sent[0],e.next=6,R.a.openBox(t,q.currentProvider);case 6:a=e.sent,M(a),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),alert(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),[]);Object(n.useEffect)((function(){U()}),[U]);var _=Object(n.useCallback)(Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,L(r.a.createElement(T.a,{color:"orange",display:"inline",title:"Getting 3Box Profile\u2026"})),e.next=4,R.a.getProfile(m);case 4:return t=e.sent,a=Object.entries(t||{}).filter((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];return!a.startsWith("proof_")&&"object"!==typeof n})),L(0===a.length?r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("i",null,"Empty"))):r.a.createElement("ul",null,a.map((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];return r.a.createElement("li",{key:a},r.a.createElement("b",null,a,":")," ",JSON.stringify(n))})))),console.info(H,q.currentProvider),e.t0=console,e.next=11,R.a.openBox(m,q.currentProvider);case 11:return e.t1=e.sent.DID,e.t0.info.call(e.t0,"DID",e.t1),e.t2=g,e.next=16,R.a.openBox(m,q.currentProvider);case 16:e.t3=e.sent.DID,(0,e.t2)(e.t3),e.next=23;break;case 20:e.prev=20,e.t4=e.catch(0),alert(e.t4.message);case 23:case"end":return e.stop()}}),e,null,[[0,20]])}))),[m]);Object(n.useEffect)((function(){_()}),[_]);var J=Object(n.useCallback)(Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!P){e.next=11;break}return e.next=3,P.openSpace("courier-contacts");case 3:return t=e.sent,e.next=6,t.syncDone;case 6:return C(t),e.next=9,t.private.get(m);case 9:(a=e.sent)&&l((function(e){return Object(k.a)(new Set([].concat(Object(k.a)(e),Object(k.a)(a.names))))}));case 11:case"end":return e.stop()}}),e)}))),[P]);Object(n.useEffect)((function(){J()}),[J]);var Y=function(){var e=Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y){e.next=4;break}console.error("Contact space isn't set"),e.next=20;break;case 4:return W(r.a.createElement(T.a,{color:"white"})),t={did:E,address:m,names:Object(k.a)(new Set(c.filter((function(e){return""!==e.trim()}))))},e.next=8,y.private.set(m,t);case 8:return e.next=10,y.private.set(E,t);case 10:return W(r.a.createElement(T.a,{color:"green"})),e.next=13,R.a.openBox(m,v.a.givenProvider);case 13:return e.sent,e.next=16,P.openSpace("courier-parcels");case 16:return a=e.sent,e.next=19,a.syncDone;case 19:W("Done");case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(b.a,{flexDirection:"column"},r.a.createElement(h.a,null,r.a.createElement(O.a,null,"Create a New Contact"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("b",null,"Names:"),r.a.createElement("ul",null,c.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement(N.a,{ml:2,value:e,my:2,onChange:function(e){var a=e.target.value;l((function(e){return[].concat(Object(k.a)(e.slice(0,t)),[a],Object(k.a)(e.slice(t+1)))}))}}),r.a.createElement(j.a,{title:"Delete",mx:2,variant:"danger",icon:"Delete",onClick:function(){return l((function(e){return 1===e.length?[""]:[].concat(Object(k.a)(e.slice(0,t)),Object(k.a)(e.slice(t+1)))}))}}),r.a.createElement(j.a,{title:"Add",icon:"Add",onClick:function(){return l((function(e){return[].concat(Object(k.a)(e.slice(0,t+1)),[""],Object(k.a)(e.slice(t+1)))}))}}))})))),r.a.createElement("li",null,r.a.createElement(b.a,{flexDirection:"row"},r.a.createElement("b",{style:{marginRight:"0.5em"}},"Decentralized ID:")," ",E||r.a.createElement(T.a,null))),r.a.createElement("li",null,r.a.createElement("b",null,"ETH Address:")," ",m),r.a.createElement("li",null,r.a.createElement(b.a,{flexDirection:"row"},r.a.createElement("b",null,"3Box Profile:")," ",!B&&r.a.createElement(T.a,null)),B)),r.a.createElement(b.a,{justifyContent:"flex-end"},r.a.createElement($.HashLink,{to:"/contacts"},r.a.createElement(j.a.Outline,{mx:2},"Cancel")),r.a.createElement(j.a,{onClick:Y,variant:"success  ",disabled:0===c.filter((function(e){return""!==e})).length||"Save"!==z},z),"Done"===z&&r.a.createElement(d.c,{to:"/contacts"}))))},ie=function(e){var t=Object(n.useState)(),a=Object(s.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(e.match.params.address),m=Object(s.a)(o,1)[0],f=Object(n.useState)(),p=Object(s.a)(f,2),E=p[0],g=p[1],x=Object(n.useState)(),w=Object(s.a)(x,2),y=w[0],C=w[1],S=Object(n.useState)(),D=Object(s.a)(S,2),P=D[0],M=D[1],I=Object(n.useState)(r.a.createElement(T.a,{display:"inline",title:"Opening 3Box\u2026"})),A=Object(s.a)(I,2),B=A[0],L=A[1],G=Object(n.useState)(),F=Object(s.a)(G,2),z=F[0],W=F[1],H=Object(n.useState)("Save"),q=Object(s.a)(H,2),U=q[0],_=q[1],J=function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.ethereum.request({method:"eth_requestAccounts"});case 2:return t=e.sent[0],e.t0=C,e.next=6,R.a.openBox(t,v.a.givenProvider);case 6:e.t1=e.sent,(0,e.t0)(e.t1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){J()}),[]);var Y=Object(n.useCallback)(Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(r.a.createElement(T.a,{color:"orange",display:"inline",title:"Getting 3Box Profile\u2026"})),e.next=3,R.a.getProfile(m);case 3:(t=e.sent).image&&t.image.length>0&&M(t.image[0].contentUrl["/"]),W(t&&0!==Object.keys(t).length?r.a.createElement("ul",null,Object.entries(t).filter((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];return!a.startsWith("proof_")&&"object"!==typeof n})).map((function(e){var t,a=Object(s.a)(e,2),n=a[0],c=a[1];return r.a.createElement("li",{key:n},r.a.createElement("b",null,n,":")," ",/^https?:\/\//.test(t=c)?r.a.createElement("a",{href:t},t):t)}))):r.a.createElement("i",null,"Empty"));case 6:case"end":return e.stop()}}),e)}))),[]);Object(n.useEffect)((function(){Y()}),[Y]);var Q=Object(n.useCallback)(Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y){e.next=11;break}return e.next=3,y.openSpace("courier-contacts");case 3:return t=e.sent,e.next=6,t.syncDone;case 6:return g(t),e.next=9,t.private.get(m);case 9:(a=e.sent)?l((function(e){return Object(k.a)(new Set([].concat(Object(k.a)(e||[]),Object(k.a)(a.names))))})):alert("Contact ".concat(m," Not Found"));case 11:case"end":return e.stop()}}),e)}))),[y]);Object(n.useEffect)((function(){Q()}),[Q]);var V=Object(n.useCallback)(Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(r.a.createElement(T.a,{color:"white"})),e.next=3,E.private.set(m,{address:m,names:Object(k.a)(new Set(c.filter((function(e){return""!==e.trim()}))))});case 3:_("Done");case 4:case"end":return e.stop()}}),e)}))),[E]);return r.a.createElement(h.a,{width:"50%",margin:"auto"},r.a.createElement(b.a,{flexDirection:"row",alignItems:"center"},P&&r.a.createElement("img",{className:"avatar",src:"//ipfs.io/ipfs/".concat(P)}),r.a.createElement(O.a,{ml:15},"Edit a Contact")),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(b.a,{flexDirection:"row"},r.a.createElement("b",null,"Names:"),!c&&r.a.createElement(T.a,{title:"Loading from 3Box\u2026",mx:2})),c&&r.a.createElement("ul",null,c.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement(N.a,{ml:2,value:e,my:2,onChange:function(e){var a=e.target.value;l((function(e){return[].concat(Object(k.a)(e.slice(0,t)),[a],Object(k.a)(e.slice(t+1)))}))}}),r.a.createElement(j.a,{title:"Delete",mx:2,variant:"danger",icon:"Delete",onClick:function(){return l((function(e){return 1===e.length?[""]:[].concat(Object(k.a)(e.slice(0,t)),Object(k.a)(e.slice(t+1)))}))}}),r.a.createElement(j.a,{title:"Add",icon:"Add",onClick:function(){return l((function(e){return[].concat(Object(k.a)(e.slice(0,t+1)),[""],Object(k.a)(e.slice(t+1)))}))}}))})))),r.a.createElement("li",null,r.a.createElement("b",null,"ETH Address:")," ",m),r.a.createElement("li",null,r.a.createElement(b.a,{flexDirection:"row"},r.a.createElement("b",null,"3Box Profile:")," ",!z&&B),z)),r.a.createElement(b.a,{justifyContent:"flex-end"},r.a.createElement($.HashLink,{to:"/contacts"},r.a.createElement(j.a.Outline,{mx:2},"Cancel")),r.a.createElement(j.a,{onClick:V,variant:"success  ",disabled:0===(c||[]).filter((function(e){return""!==e})).length||"Save"!==U},U),"Done"===U&&r.a.createElement(d.c,{to:"/contacts"})))},ue=a(94),se=a(2080),me=a(133),de=a(862),fe=a.n(de),pe=function(){var e=Object(n.useState)({width:8.5,height:11}),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)({width:2.625,height:2}),o=Object(s.a)(l,2),m=o[0],d=o[1],f=Object(n.useState)({width:1/8,height:0}),p=Object(s.a)(f,2),E=p[0],g=p[1],v=Object(n.useState)({width:7/32,height:15/32}),x=Object(s.a)(v,2),j=x[0],O=x[1],w=Object(n.useState)([]),y=Object(s.a)(w,2),C=y[0],S=y[1],D={'Avery 6793 (15\xd7(2"\xd72\u215d"))':{page:{width:8.5,height:11},label:{width:2.625,height:2},outerGutter:{width:7/32,height:15/32},innerGutter:{width:1/8,height:0}},'Avery 6874 (6\xd7(3"\xd73\xbe"))':{page:{width:8.5,height:11},label:{width:3.75,height:3},outerGutter:{width:3/8,height:5/8},innerGutter:{width:1/4,height:3/8}}},P={page:c,label:d,innerGutter:g,outerGutter:O},M=Object(n.useCallback)(Object(u.a)(i.a.mark((function e(){var t,n,r,c,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Math.round((a.height-2*j.height+E.height)/(m.height+E.height)),n=Math.round((a.width-2*j.width+E.width)/(m.width+E.width)),r=Object(k.a)(new Array(Math.round(t*n))).map(A),e.next=5,Promise.all(r.map((function(e){return new Promise((function(t,a){fe.a.toString("https://pkg.dhappy.org/#/cel/".concat(e),{margin:0,errorCorrectionLevel:"low"},(function(e,a){if(e)throw e;t(a)}))}))})));case 5:c=e.sent,l=r.map((function(e,t){return{guid:e,qr:c[t]}})),S(Object(W.b)(l,n));case 8:case"end":return e.stop()}}),e)}))),[a,m,j,E]);Object(n.useEffect)((function(){M()}),[M]);var I=function(e,t){return function(a){var n=a.target.value;P[e]?P[e]((function(e){return Object(U.a)(Object(U.a)({},e),{},Object(ue.a)({},t,n))})):console.error("No Setter For: ".concat(e))}},A=function(){var e=new Array;Object(se.a)({},e);return me.encode(e)},T=function(e,t,a){var n=96*(j.width+a*(m.width+E.width)),c=96*(j.height+t*(m.height+E.height)),l=96*(j.height+m.height/2),o=.8*Math.min(m.width,m.height)*96;return r.a.createElement("g",{key:e.guid,transform:"translate(".concat(n,", ").concat(c,") rotate(-90) translate(").concat(-l,", 0)")},function(e){var t=Object(W.b)(e,8);return r.a.createElement("text",{style:{textAnchor:"middle",fontFamily:"'Source Code Pro', monospace",fontSize:25}},t.map((function(e,t){return r.a.createElement("tspan",{key:t,x:m.height/2*96,dy:25},Object(W.b)(e,Math.ceil(e.length/2)).join("-"))})))}(e.guid),r.a.createElement("image",{width:o,height:o,x:.22*o/2,y:96*m.width-o-.05*o,xlinkHref:"data:image/svg+xml;utf8,".concat(encodeURIComponent(e.qr))}))};return r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(h.a,{className:"config"},r.a.createElement(b.a,{flexDirection:"column"},r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",null,"Page Size:"),r.a.createElement("input",{type:"number",value:a.width,onChange:I("page","width")}),r.a.createElement("span",null,"\xd7"),r.a.createElement("input",{value:a.height,onChange:I("page","height")})),r.a.createElement("fieldset",null,r.a.createElement("label",null,"Label:"),r.a.createElement("input",{value:m.width,onChange:I("label","width")}),r.a.createElement("span",null,"\xd7"),r.a.createElement("input",{value:m.height,onChange:I("label","height")})),r.a.createElement("fieldset",null,r.a.createElement("label",null,"Outer Gutters:"),r.a.createElement("input",{value:j.width,onChange:I("outerGutter","width")}),r.a.createElement("span",null,"\xd7"),r.a.createElement("input",{value:j.height,onChange:I("outerGutter","height")})),r.a.createElement("fieldset",null,r.a.createElement("label",null,"Inner Gutters:"),r.a.createElement("input",{value:E.width,onChange:I("innerGutter","width")}),r.a.createElement("span",null,"\xd7"),r.a.createElement("input",{value:E.height,onChange:I("innerGutter","height")}))),r.a.createElement(Y.a,{label:"Presets:"},r.a.createElement("select",{onChange:function(e){for(var t=D[e.target.value],a=0,n=Object.keys(P);a<n.length;a++){var r=n[a];P[r](t[r])}}},Object.keys(D).map((function(e,t){return r.a.createElement("option",{key:t},e)})))))),r.a.createElement(b.a,null,r.a.createElement("svg",{viewBox:[0,0,96*a.width,96*a.height].join(" "),width:"".concat(a.width,"in"),height:"".concat(a.height,"in"),transform:"translate(0, ".concat(96*j.height,")")},C.map((function(e,t){return e.map((function(e,a){return T(e,t,a)}))})))))};var he=function(){var e=Object(n.useState)(),t=Object(s.a)(e,2),a=t[0],c=t[1],l=new v.a(v.a.givenProvider),o=Object(n.useCallback)(Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=c,e.next=4,l.eth.net.getId();case 4:e.t1=e.sent,(0,e.t0)(e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),console.error("App#setNet",e.t2);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),[l.eth.net]);Object(n.useEffect)((function(){o()}),[o]);var f=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent);return r.a.createElement(m.HashRouter,null,r.a.createElement(p.a,{currentNetwork:a,requiredNetwork:4},{notWeb3CapableBrowserMessage:r.a.createElement(h.a,{maxWidth:"25em",mx:"auto",marginTop:"1.5em"},r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(E.a,{as:"a",href:"//metamask.app.link/dapp/pkg.dhappy.org",mx:"auto"},f?"Launch in MetaMask":"Get Metamask"))),noNetworkAvailableMessage:r.a.createElement(h.a,{maxWidth:"25em",mx:"auto",marginTop:"1.5em"},r.a.createElement(b.a,{alignItems:"center",flexDirection:"column"},r.a.createElement(E.a,{as:"a",href:"//metamask.io/download.html",mx:"auto"},f?"Launch in MetaMask":"Get Metamask")))}),r.a.createElement(d.g,null,r.a.createElement(d.d,{path:"/",exact:!0,component:w}),r.a.createElement(d.d,{path:"/overview",component:ae}),r.a.createElement(d.d,{path:"/ppl/:address/edit",component:ie}),r.a.createElement(d.d,{path:"/ppl/new",component:oe}),r.a.createElement(d.d,{path:"/ppl",component:le}),r.a.createElement(d.d,{path:"/jobs/public",component:q}),r.a.createElement(d.d,{path:"/jobs/private",component:J}),r.a.createElement(d.d,{path:"/cel/:guid",component:K}),r.a.createElement(d.d,{path:"/parcels",component:Z}),r.a.createElement(d.d,{path:"/contracts/new",component:ee.a}),r.a.createElement(d.d,{path:"/contracts/:id/join",component:te}),r.a.createElement(d.d,{path:"/contracts",component:X}),r.a.createElement(d.d,{path:"/labels",component:pe})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(he,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},356:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(857),l=a.n(c);a(388);t.a=function(e){return r.a.createElement(l.a,{delay:200,onError:function(e){alert(e.message)},onScan:e.onScan,style:{width:"50vw",maxHeight:"50vh"}})}},388:function(e,t,a){},393:function(e,t){},859:function(e,t,a){"use strict";(function(e){var n=a(80),r=a(94),c=a(860),l=a(102),o=a(39),i=a(3),u=a.n(i),s=a(23),m=a(21),d=a(0),f=a.n(d),p=a(2081),h=a(2082),b=a(2075),E=a(2083),g=a(2076),v=a(2077),x=a(2078),j=a(106),O=a(136),w=a(175),k=a(162),y=a(63),C=a(203),S=a(865),D=a(866),P=a(2079),M=a(173),I=a(514),A=a(96),T=a(864),B=a(861),L=a(61),G=a.n(L),F=a(48),N=a.n(F),z=a(2080),R=a(133),W=(a(483),a(97)),H=a(356);t.a=function(t){var a=Object(d.useState)(),i=Object(m.a)(a,2),L=i[0],F=i[1],q=Object(d.useState)({lat:53,lng:12}),U=Object(m.a)(q,2),_=U[0],J=U[1],Y=Object(d.useState)(_),Q=Object(m.a)(Y,2),V=Q[0],Z=Q[1],$=Object(d.useState)(200),K=Object(m.a)($,2),X=K[0],ee=K[1],te=Object(d.useState)(),ae=Object(m.a)(te,2),ne=ae[0],re=ae[1],ce=Object(d.useState)(0),le=Object(m.a)(ce,2),oe=le[0],ie=le[1],ue=Object(d.useState)(),se=Object(m.a)(ue,2),me=se[0],de=se[1],fe=Object(d.useState)(0),pe=Object(m.a)(fe,2),he=pe[0],be=pe[1],Ee=Object(d.useState)(),ge=Object(m.a)(Ee,2),ve=ge[0],xe=ge[1],je=Object(d.useState)([]),Oe=Object(m.a)(je,2),we=Oe[0],ke=Oe[1],ye=Object(d.useState)(!1),Ce=Object(m.a)(ye,2),Se=Ce[0],De=Ce[1],Pe=(new N.a(N.a.givenProvider),[]);Object(z.a)({},Pe);var Me=R.encode(Pe),Ie=Object(d.useState)(Object(W.b)(Me,6).join("\u2013")),Ae=Object(m.a)(Ie,2),Te=Ae[0],Be=Ae[1];Object(d.useEffect)((function(){B.a.register(T.a)}),[]);var Le=Object(d.useCallback)(Object(s.a)(u.a.mark((function e(){var t,a,n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=N.a.givenProvider)||(t=window.web3&&window.web3.currentProvider),t){e.next=4;break}throw new Error("Couldn't Find an Ethereum Provider.\n\nCan't connect to databases.");case 4:return a=new N.a(t),e.next=7,a.eth.getAccounts();case 7:return n=e.sent[0],e.next=10,G.a.openBox(n,N.a.givenProvider);case 10:return r=e.sent,e.t0=xe,e.next=14,r.openSpace("courier");case 14:return e.next=16,e.sent.DID;case 16:return e.t1=e.sent,(0,e.t0)(e.t1),e.next=20,r.openSpace("courier-contacts");case 20:return c=e.sent,e.next=23,c.syncDone;case 23:return e.t2=de,e.next=26,c.private.all();case 26:e.t3=e.sent,(0,e.t2)(e.t3);case 28:case"end":return e.stop()}}),e)}))),[]);Object(d.useEffect)((function(){Le()}),[Le]),Object(d.useEffect)((function(){navigator.permissions.query({name:"geolocation"}).then((function(e){if("granted"===e.state||"prompt"===e.state){navigator.geolocation.getCurrentPosition((function(e){var t={lat:e.coords.latitude,lng:e.coords.longitude};J(t),Z(t)}),(function(e){return alert("Error Getting Current Position: '".concat(e.message,"'"))}))}else"denied"===e.state?alert("Couldn't Access GPS"):alert("Unknown GPS Code: ".concat(e.state))}))}),[]),Object(d.useEffect)((function(){var e=function(){};return window.addEventListener("hashchange",e),function(){return window.removeEventListener("hashchange",e)}}),[]);var Ge=function(e){F(e)},Fe={lat:V.lat-_.lat,lng:V.lng-_.lng},Ne=Math.sqrt(Math.pow(Fe.lat,2)+Math.pow(Fe.lng,2)),ze=[{lat:_.lat+Fe.lat/2-2*Ne,lng:_.lng+Fe.lng/2-5*Ne},{lat:_.lat+Fe.lat/2+2*Ne,lng:_.lng+Fe.lng/2+5*Ne}],Re=function(e){Z(e.latlng),ee(Object(W.d)(_,e.latlng)),ie(X/750)},We=["Mail","Map","Info","MarkunreadMailbox","Dai","LocalTaxi","Save"],He=["Configure whether sending or receiving.","Choose a waypoint and travel time for meeting the courier.","Set the package id.","Choose the party for the other end of your transaction.","Specify the bond you would like on the delivery.","Choose couriers to request bids from.","Review the contract and send it for completion."],qe=function(e){var t=e.idx,a=e.onBack,n=e.onNext,r=e.nextAvail,c=void 0===r||r;return f.a.createElement(j.a,{mt:25,mb:10,justifyContent:"flex-end",alignItems:"center",flexDirection:"row"},Object(o.a)(new Array(We.length)).map((function(e,a){return f.a.createElement(A.HashLink,{key:a,to:"#".concat(a+1)},a+1!==t?f.a.createElement(O.a.Outline,{size:"small",icon:We[a%We.length],title:He[a%He.length],px:0,mx:0,mt:0}):f.a.createElement(O.a,{size:"small",icon:We[a%We.length],title:He[a%He.length],px:0,mx:1,mt:0}))})),f.a.createElement(A.HashLink,{to:"#".concat(t-1)},f.a.createElement(O.a.Outline,{onClick:a,icon:"ArrowBack",mt:3,mx:1},"Back")),f.a.createElement(A.HashLink,{to:"#".concat(t+1),disabled:!c},f.a.createElement(O.a,{onClick:n,icon:"ArrowForward",mt:3,mx:1,disabled:!c},"Next")))},Ue=function(){var e=Object(s.a)(u.a.mark((function e(t,a){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.openBox(t,N.a.givenProvider);case 2:return n=e.sent,e.next=5,n.openSpace("courier");case 5:return r=e.sent,e.next=8,r.joinThread("inbox");case 8:return c=e.sent,e.next=11,c.post(a);case 11:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return f.a.createElement(j.a,{className:"cards",flexDirection:"column"},f.a.createElement(w.a,{id:"1",className:"card"},f.a.createElement(j.a,{alignItems:"center",flexDirection:"column"},f.a.createElement(k.a,null,"Which are you?"),f.a.createElement(j.a,{flexDirection:"row"},f.a.createElement(A.HashLink,{to:"#2",onClick:function(){return Ge("pick-up")}},f.a.createElement(O.a,{variant:"pick-up"===L&&"success",mx:"0.5em"},"Sender")),f.a.createElement(A.HashLink,{to:"#2",onClick:function(){return Ge("dropoff")}},f.a.createElement(O.a,{variant:"dropoff"===L&&"success",mx:"0.5em"},"Recipient"))))),f.a.createElement(w.a,{id:"2",className:"card map"},qe({idx:2}),f.a.createElement(j.a,{alignItems:"center",flexDirection:"column"},f.a.createElement(k.a,null,"Where are you?"),f.a.createElement(y.a,{indent:"1.5em",fontSize:22},"Your location is anonymized by specifying your distance from a waypoint in terms of travel time."),f.a.createElement(y.a,{indent:"1.5em",fontSize:22},"Please place your waypoint within \xbc mile of a public road. Once your courier is arranged you will get a chat to orchestrate your parcel pickup. If, for whatever reason, you are unresponsive, the courier will go to the waypoint."),f.a.createElement(y.a,{indent:"1.5em",fontSize:22},"If they still can't reach you they can register a wait complaint, but they have to be within \xbc mile of the waypoint."),f.a.createElement(p.a,{center:_,zoom:11,width:.8,style:{margin:"1em auto"}},f.a.createElement(h.a,{url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="//osm.org/copyright">OpenStreetMap</a> contributors'}),f.a.createElement(b.a,{position:V,draggable:!0,onDrag:Re},f.a.createElement(E.a,null,"".concat(Object(W.a)(L)," Waypoint"))),f.a.createElement(g.a,{center:_,radius:X}),f.a.createElement(v.a,{positions:[_,V]}),f.a.createElement(x.a,{bounds:ze},f.a.createElement("text",{x:"50%",y:"50%",fill:"black",fontSize:25,stroke:"black",textAnchor:"middle"},oe&&"".concat(oe.toFixed(1),"min")))),f.a.createElement(j.a,{alignItems:"center",flexDirection:"row"},f.a.createElement(y.a,{mx:"0.5em"},"".concat(Object(W.a)(L)," Waypoint:")),f.a.createElement(C.a,{type:"number",value:V.lat,onChange:function(e){var t=""!==e.target.value?parseFloat(e.target.value):_.lat;Re({latlng:Object(l.a)(Object(l.a)({},V),{},{lat:t})})}}),f.a.createElement(y.a,{fontSize:"200%"},"\xd7"),f.a.createElement(C.a,{type:"number",value:V.lng,onChange:function(e){var t=""!==e.target.value?parseFloat(e.target.value):_.lng;Re({latlng:Object(l.a)(Object(l.a)({},V),{},{lng:t})})}})),f.a.createElement(j.a,{alignItems:"center",flexDirection:"row",mt:3},f.a.createElement(y.a,{mx:"0.5em"},"Time to ".concat("pick-up"===L?"Sender":"Recipient",":")),f.a.createElement(C.a,{width:"4em",type:"number",value:Math.ceil(oe||0),onChange:function(e){var t=""!==e.target.value?parseFloat(e.target.value):oe;ie(t)}}),f.a.createElement(y.a,null,"minute",1===oe?"":"s")))),f.a.createElement(w.a,{id:"3",className:"card"},qe({idx:3}),f.a.createElement(j.a,{alignItems:"center",flexDirection:"column"},f.a.createElement(k.a,null,"What is the package id?"),f.a.createElement(y.a,{fontSize:22},"Every parcel in the network has a unique identifier that should be ",f.a.createElement(A.HashLink,{to:"/labels"},"scannable as a QR code")," or NFC tag. Barring that, the id should be written on the package."),f.a.createElement(j.a,{alignItems:"center",flexDirection:"row"},f.a.createElement(C.a,{width:"35ch",value:Te,textAlign:"center",onChange:function(e){return Be(e.target.value)}}),f.a.createElement(O.a,{icon:"Pages",title:"Scan QR Code",onClick:function(){return De(!0)}})),Se&&f.a.createElement(w.a,null,f.a.createElement(H.a,{onScan:function(e){if(e){var t=e.match(/^(https?:)?\/\/pkg.dhappy.org\/(#\/)?cel\/([^/]+)/i);t&&(Be(t[3]),De(!1))}}})))),f.a.createElement(w.a,{id:"4",className:"card"},qe({idx:4}),f.a.createElement(j.a,{alignItems:"center",flexDirection:"column"},f.a.createElement(k.a,null,"Who are you ","pick-up"===L?"sending it to":"getting it from","?"),me?f.a.createElement(D.a,null,f.a.createElement("thead",null,f.a.createElement("tr",null,f.a.createElement("th",null,"Select"),f.a.createElement("th",null,"Names"))),f.a.createElement("tbody",null,Object.entries(me).map((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return f.a.createElement("tr",{key:a,style:{cursor:"pointer"}},f.a.createElement("td",null,f.a.createElement(P.a,{checked:ne===n,onChange:function(e){re((function(e){return console.info(e,n,e===n),e!==n?n:null}))}})),f.a.createElement("td",{onClick:function(){return re(n)}},Object(W.c)(n.names)))})))):f.a.createElement(f.a.Fragment,null,f.a.createElement(k.a,null,"Loading Contacts"),f.a.createElement(S.a,null)))),f.a.createElement(w.a,{id:"5",className:"card"},qe({idx:5}),f.a.createElement(j.a,{alignItems:"center",flexDirection:"column"},f.a.createElement(k.a,null,"What bond do you want on the delivery?"),f.a.createElement(y.a,{indent:"1.5em",fontSize:22},"Couriers stake a bond as insurance for their good faith. If your courier fails to check in at a waypoint or receive a delivery receipt, this is the what you get to cover your loss."),f.a.createElement(j.a,{alignItems:"center",flexDirection:"row"},f.a.createElement(C.a,{my:3,type:"number",value:he,onChange:function(e){var t=""!==e.target.value?parseFloat(e.target.value):0;t<0&&(t*=(Object(c.a)("bond"),-1)),be(t)}}),f.a.createElement(y.a,{ml:2},f.a.createElement(M.a,{name:"Dai"})," DAI")))),f.a.createElement(w.a,{id:"6",className:"card"},qe({idx:6}),f.a.createElement(j.a,{alignItems:"center",flexDirection:"column"},f.a.createElement(k.a,null,"Choose Couriers"),f.a.createElement(y.a,{indent:"1.5em",fontSize:"15pt"},"These couriers will be notified of your contract and given an opportunity to bid."),me?f.a.createElement(D.a,null,f.a.createElement("thead",null,f.a.createElement("tr",null,f.a.createElement("th",null,"Select"),f.a.createElement("th",null,"Names"))),f.a.createElement("tbody",null,Object.entries(me).map((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return f.a.createElement("tr",{key:a},f.a.createElement("td",null,f.a.createElement(I.a,{checked:we.includes(n),onChange:function(e){e.target.checked?ke((function(e){return Object(o.a)(new Set([].concat(Object(o.a)(e),[n])))})):ke((function(e){return e.filter((function(e){return e!==n}))}))}})),f.a.createElement("td",{onClick:function(e){ke((function(e){return e.includes(n)?e.filter((function(e){return e!==n})):Object(o.a)(new Set([].concat(Object(o.a)(e),[n])))}))}},Object(W.c)(n.names)))})))):f.a.createElement(f.a.Fragment,null,f.a.createElement(k.a,null,"Loading Contacts"),f.a.createElement(S.a,null)))),f.a.createElement(w.a,{id:"7",className:"card"},qe({idx:7,nextAvail:void 0!==L,onNext:function(){var t=Object(s.a)(u.a.mark((function t(a){var c,l,o,i,s,m,d,f,p,h,b,E,g,v,x,j;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((c=N.a.givenProvider)||(c=window.web3&&window.web3.currentProvider),c){t.next=4;break}throw new Error("Couldn't Find an Ethereum Provider.\n\nCan't connect to databases.");case 4:return l=new N.a(c),t.next=7,l.eth.getAccounts();case 7:return o=t.sent[0],t.next=10,G.a.openBox(o,N.a.givenProvider);case 10:return i=t.sent,t.next=13,i.openSpace("courier");case 13:return s=t.sent,t.next=16,s.waitSync;case 16:return m=R.decode(Te.replace(/-/g,"")),t.next=19,crypto.subtle.digest("SHA-256",m);case 19:return d=t.sent,f=R.encode(e.from(d)),p="bids-".concat(f),t.next=24,s.createConfidentialThread(p);case 24:return h=t.sent,b=Object(r.a)({bond:(he||0)*Math.pow(10,18)},L,{contact:ve,lat:Math.round(V.lat*Math.pow(10,6)),lng:Math.round(V.lng*Math.pow(10,6)),travelTime:Math.round(60*oe)}),console.info("TCT",b),t.next=29,h.post({contract:b});case 29:return t.next=31,h.addMember(ne.address);case 31:return E=o,t.next=34,Ue(ne.address,{awaiting:h.address,creator:E});case 34:g=Object(n.a)(we),t.prev=35,g.s();case 37:if((v=g.n()).done){t.next=46;break}return x=v.value,t.next=41,h.addMember(x.address);case 41:return t.next=43,Ue(x.address,{contract:h.address,creator:E});case 43:console.info(x);case 44:t.next=37;break;case 46:t.next=51;break;case 48:t.prev=48,t.t0=t.catch(35),g.e(t.t0);case 51:return t.prev=51,g.f(),t.finish(51);case 54:return t.next=56,h.getPosts();case 56:j=t.sent,console.info(j);case 58:case"end":return t.stop()}}),t,null,[[35,48,51,54]])})));return function(e){return t.apply(this,arguments)}}()}),f.a.createElement(j.a,{alignItems:"center",flexDirection:"column"},f.a.createElement(k.a,null,"Get ","pick-up"===L?"Recipient":"Sender"," Information"),L?ne?f.a.createElement(y.a,{fontSize:22},"The contract will now be sent to ",ne.names[0]," for their location information. ",we.length>0&&"Links to the bidding database will be sent to the following couriers for bids:"):f.a.createElement(y.a,{fontSize:22},"You have not ",f.a.createElement(A.HashLink,{to:"#4"},"selected the other party"),"."):f.a.createElement(y.a,{fontSize:22},"You need to specify ",f.a.createElement(A.HashLink,{to:"#1"},"whether you are sending or receiving"),".")),L&&ne&&f.a.createElement(j.a,{alignItems:"start",flexDirection:"column"},f.a.createElement("ul",null,we.map((function(e,t){return f.a.createElement("li",{key:t},Object(W.c)(e.names))}))))))}}).call(this,a(4).Buffer)},868:function(e,t,a){e.exports=a(2071)},873:function(e,t,a){},890:function(e,t){},911:function(e,t){},913:function(e,t){},928:function(e,t){},97:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return o}));var n=function(e){var t=e.length;return 0===t||1===t?e[0]:2===t?"".concat(e[0]," & ").concat(e[1],"}"):[e.slice(0,t-1).join(", "),e.slice(-1)[0]].join(", & ")},r=function(e){return(e||"").split("-").map((function(e){return(e[0]&&e[0].toUpperCase()||"")+e.slice(1)})).join("-")},c=function(e){return e*Math.PI/180},l=function(e,t){var a={1:{lat:c(e.lat),lng:c(e.lng)},2:{lat:c(t.lat),lng:c(t.lng)}},n=a[2].lat-a[1].lat,r=a[2].lng-a[1].lng,l=Math.pow(Math.sin(n/2),2)+Math.cos(a[1].lat)*Math.cos(a[2].lat)*Math.pow(Math.sin(r/2),2);return 6371e3*(2*Math.asin(Math.sqrt(l)))},o=function(e,t){for(var a="string"===typeof e,n=Array.from(e),r=[];n.length;){var c=n.splice(0,t);r.push(a?c.join(""):c)}return r}},994:function(e,t){},996:function(e,t){}},[[868,1,2]]]);
//# sourceMappingURL=main.15abc370.chunk.js.map